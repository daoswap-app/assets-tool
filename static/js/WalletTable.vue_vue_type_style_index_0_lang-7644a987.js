import{t as s}from"./___vite-browser-external_commonjs-proxy-4a27f4fc.js";import{g as q,M,S as Q}from"./web3-ad2cfba4.js";import{x as L,r as c,w as W,a7 as u,y as x,H as E,I as e,P as l,M as O,O as h,u as i,z as P,a0 as z,F as H,o as X,A as U,L as $}from"./runtime-core.esm-bundler-c80a0204.js";import{c as G,i as J}from"./addresses-61594ce1.js";import{A as K}from"./arrow-down-s-line-da487a0d.js";const Y=L({__name:"ChangeThreshold",props:{visible:{type:Boolean,default:!1},data:{type:Object,default:()=>null},connectedWallet:{type:Object,default:null},web3:{type:Object,default:null}},emits:["update:visible","refresh-data"],setup(B,{emit:F}){const a=B,m=c(!1),w=c(!1),_=c(0),V={confirmNumber:1},R=c(),r=c(V),p=async()=>await R.value.validate(g=>!!g),D=async()=>{if(await p()){m.value=!0;const g=q(M,a.data.token,a.web3),v=await g.methods.changeThreshold(r.value.confirmNumber).encodeABI(),t={destination:a.data.token,value:"0",data:v};g.methods.submitTransaction(t.destination,t.value,t.data).send({from:a.connectedWallet.address}).then(()=>{F("refresh-data")}).catch(o=>{console.error(o)}).finally(()=>{m.value=!1,N()})}},N=()=>{w.value=!1};return W(()=>w.value,k=>{F("update:visible",k)}),W(()=>a.visible,k=>{w.value=k}),W(()=>a.data,k=>{m.value=!0,k?(_.value=parseInt(k.ownerCount),r.value.confirmNumber=k.threshold):r.value=V,m.value=!1}),(k,g)=>{const v=u("el-option"),t=u("el-select"),o=u("el-col"),n=u("el-row"),d=u("el-form-item"),b=u("el-form"),I=u("el-button"),S=u("el-dialog");return x(),E(S,{modelValue:w.value,"onUpdate:modelValue":g[1]||(g[1]=C=>w.value=C),title:i(s)("wallet.changeThreshold"),width:"90%",draggable:"","close-on-click-modal":!1,"before-close":N},{footer:e(()=>[l(I,{loading:m.value,onClick:N},{default:e(()=>[O(h(i(s)("wallet.btnCancel")),1)]),_:1},8,["loading"]),l(I,{loading:m.value,type:"primary",onClick:D},{default:e(()=>[O(h(i(s)("wallet.btnSubmit")),1)]),_:1},8,["loading"])]),default:e(()=>[l(b,{ref_key:"walletFormRef",ref:R,model:r.value,"label-width":"100px",class:"demo-ruleForm","hide-required-asterisk":!0,"label-position":"top"},{default:e(()=>[l(d,{prop:"confirmNumber",label:i(s)("wallet.confirmNumber"),style:{width:"100%"},rules:[{required:!0,message:i(s)("wallet.please select confirm number"),trigger:"change"}]},{default:e(()=>[l(n,{gutter:20,style:{width:"100%"}},{default:e(()=>[l(o,{xs:8,md:2},{default:e(()=>[l(t,{modelValue:r.value.confirmNumber,"onUpdate:modelValue":g[0]||(g[0]=C=>r.value.confirmNumber=C)},{default:e(()=>[(x(!0),P(H,null,z(_.value,C=>(x(),E(v,{key:C,label:C,value:C},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),l(o,{xs:1,md:1},{default:e(()=>[O("/")]),_:1}),l(o,{xs:8,md:2},{default:e(()=>[O(h(_.value),1)]),_:1}),l(o,{xs:7,md:19})]),_:1})]),_:1},8,["label","rules"])]),_:1},8,["model"])]),_:1},8,["modelValue","title"])}}}),Z=L({__name:"AddOwner",props:{visible:{type:Boolean,default:!1},data:{type:Object,default:()=>null},connectedWallet:{type:Object,default:null},web3:{type:Object,default:null}},emits:["update:visible","refresh-data"],setup(B,{emit:F}){const a=B,m=c(!1),w=c(!1),_=c([]),V=c(0),R={owner:"",confirmNumber:1},r=c(),p=c(R),D=(v,t,o)=>{t===""?o(new Error(s("wallet.please input wallet address"))):(p.value.owner=G(p.value.owner),J(p.value.owner)?_.value.filter(d=>d.toLowerCase()===t.toLowerCase()).length>0?o(new Error(s("wallet.owner is already added"))):o():o(new Error(s("wallet.invalid wallet address"))))},N=async()=>await r.value.validate(t=>!!t),k=async()=>{if(await N()){m.value=!0;const t=q(M,a.data.token,a.web3),o=await t.methods.addOwnerWithThreshold(p.value.owner,p.value.confirmNumber).encodeABI(),n={destination:a.data.token,value:"0",data:o};t.methods.submitTransaction(n.destination,n.value,n.data).send({from:a.connectedWallet.address}).then(()=>{F("refresh-data")}).catch(d=>{console.error(d)}).finally(()=>{m.value=!1,g()})}},g=()=>{w.value=!1};return W(()=>w.value,v=>{F("update:visible",v)}),W(()=>a.visible,v=>{w.value=v}),W(()=>a.data,v=>{m.value=!0,v?(_.value=v.owners,V.value=parseInt(v.ownerCount)+1,p.value.confirmNumber=v.threshold):p.value=R,m.value=!1}),(v,t)=>{const o=u("el-input"),n=u("el-col"),d=u("el-row"),b=u("el-form-item"),I=u("el-divider"),S=u("el-option"),C=u("el-select"),T=u("el-form"),A=u("el-button"),f=u("el-dialog");return x(),E(f,{modelValue:w.value,"onUpdate:modelValue":t[2]||(t[2]=y=>w.value=y),title:i(s)("wallet.addOwner"),width:"90%",draggable:"","close-on-click-modal":!1,"before-close":g},{footer:e(()=>[l(A,{loading:m.value,onClick:g},{default:e(()=>[O(h(i(s)("wallet.btnCancel")),1)]),_:1},8,["loading"]),l(A,{loading:m.value,type:"primary",onClick:k},{default:e(()=>[O(h(i(s)("wallet.btnSubmit")),1)]),_:1},8,["loading"])]),default:e(()=>[l(T,{ref_key:"walletFormRef",ref:r,model:p.value,"label-width":"100px",class:"demo-ruleForm","hide-required-asterisk":!0,"label-position":"top"},{default:e(()=>[l(b,{prop:"owner",label:i(s)("wallet.owners"),style:{width:"100%"},rules:[{validator:D,trigger:"blur"}]},{default:e(()=>[l(d,{gutter:20,style:{width:"100%"}},{default:e(()=>[l(n,{span:24},{default:e(()=>[l(o,{modelValue:p.value.owner,"onUpdate:modelValue":t[0]||(t[0]=y=>p.value.owner=y)},null,8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["label","rules"]),l(I),l(b,{prop:"confirmNumber",label:i(s)("wallet.confirmNumber"),style:{width:"100%"},rules:[{required:!0,message:i(s)("wallet.please select confirm number"),trigger:"change"}]},{default:e(()=>[l(d,{gutter:20,style:{width:"100%"}},{default:e(()=>[l(n,{xs:8,md:2},{default:e(()=>[l(C,{modelValue:p.value.confirmNumber,"onUpdate:modelValue":t[1]||(t[1]=y=>p.value.confirmNumber=y)},{default:e(()=>[(x(!0),P(H,null,z(V.value,y=>(x(),E(S,{key:y,label:y,value:y},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),l(n,{xs:1,md:1},{default:e(()=>[O("/")]),_:1}),l(n,{xs:8,md:2},{default:e(()=>[O(h(V.value),1)]),_:1}),l(n,{xs:7,md:19})]),_:1})]),_:1},8,["label","rules"])]),_:1},8,["model"])]),_:1},8,["modelValue","title"])}}}),ee=L({__name:"SwapOwner",props:{visible:{type:Boolean,default:!1},data:{type:Object,default:()=>null},connectedWallet:{type:Object,default:null},web3:{type:Object,default:null},owner:{type:String,default:""}},emits:["update:visible","refresh-data"],setup(B,{emit:F}){const a=B,m=c(!1),w=c(!1),_=c([]),V={owner:"",newOwner:""},R=c(),r=c(V),p=c(""),D=(t,o,n)=>{o===""?n(new Error(s("wallet.please input wallet address"))):(r.value.newOwner=G(r.value.newOwner),J(r.value.newOwner)?_.value.filter(b=>b.toLowerCase()===o.toLowerCase()).length>0?n(new Error(s("wallet.owner is already added"))):n():n(new Error(s("wallet.invalid wallet address"))))},N=async()=>await R.value.validate(o=>!!o),k=async()=>{if(await N()){m.value=!0;const o=q(M,a.data.token,a.web3),n=await o.methods.swapOwner(p.value,r.value.owner,r.value.newOwner).encodeABI(),d={destination:a.data.token,value:"0",data:n};o.methods.submitTransaction(d.destination,d.value,d.data).send({from:a.connectedWallet.address}).then(()=>{F("refresh-data")}).catch(b=>{console.error(b)}).finally(()=>{m.value=!1,v()})}},g=async()=>{const t=a.data.owners,o=t.findIndex(d=>d===r.value.owner),n=parseInt(o)-1;n>=0?p.value=t[n]:p.value=Q},v=()=>{w.value=!1};return W(()=>w.value,t=>{F("update:visible",t)}),W(()=>a.visible,t=>{w.value=t}),W(()=>a.data,t=>{m.value=!0,t?(_.value=t.owners,r.value.owner=a.owner):r.value=V,g(),m.value=!1}),W(()=>a.owner,t=>{r.value.owner=t,g()}),(t,o)=>{const n=u("el-input"),d=u("el-col"),b=u("el-row"),I=u("el-form-item"),S=u("el-form"),C=u("el-button"),T=u("el-dialog");return x(),E(T,{modelValue:w.value,"onUpdate:modelValue":o[2]||(o[2]=A=>w.value=A),title:i(s)("wallet.swapOwner"),width:"90%",draggable:"","close-on-click-modal":!1,"before-close":v},{footer:e(()=>[l(C,{loading:m.value,onClick:v},{default:e(()=>[O(h(i(s)("wallet.btnCancel")),1)]),_:1},8,["loading"]),l(C,{loading:m.value,type:"primary",onClick:k},{default:e(()=>[O(h(i(s)("wallet.btnSubmit")),1)]),_:1},8,["loading"])]),default:e(()=>[l(S,{ref_key:"walletFormRef",ref:R,model:r.value,"label-width":"100px",class:"demo-ruleForm","hide-required-asterisk":!0,"label-position":"top"},{default:e(()=>[l(I,{prop:"owner",label:i(s)("wallet.oldOwner"),style:{width:"100%"},rules:[{required:!0,message:i(s)("wallet.please input wallet address"),trigger:"blur"}]},{default:e(()=>[l(b,{gutter:20,style:{width:"100%"}},{default:e(()=>[l(d,{span:24},{default:e(()=>[l(n,{modelValue:r.value.owner,"onUpdate:modelValue":o[0]||(o[0]=A=>r.value.owner=A),disabled:!0},null,8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["label","rules"]),l(I,{prop:"newOwner",label:i(s)("wallet.newOwner"),style:{width:"100%"},rules:[{validator:D,trigger:"blur"}]},{default:e(()=>[l(b,{gutter:20,style:{width:"100%"}},{default:e(()=>[l(d,{span:24},{default:e(()=>[l(n,{modelValue:r.value.newOwner,"onUpdate:modelValue":o[1]||(o[1]=A=>r.value.newOwner=A)},null,8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["label","rules"])]),_:1},8,["model"])]),_:1},8,["modelValue","title"])}}}),le=L({__name:"RemoveOwner",props:{visible:{type:Boolean,default:!1},data:{type:Object,default:()=>null},connectedWallet:{type:Object,default:null},web3:{type:Object,default:null},owner:{type:String,default:""}},emits:["update:visible","refresh-data"],setup(B,{emit:F}){const a=B,m=c(!1),w=c(!1),_=c(0),V={owner:"",confirmNumber:1},R=c(),r=c(V),p=c(""),D=(t,o,n)=>{o===""?n(new Error(s("wallet.please input wallet address"))):(r.value.owner=G(r.value.owner),J(r.value.owner)?n():n(new Error(s("wallet.invalid wallet address"))))},N=async()=>await R.value.validate(o=>!!o),k=async()=>{if(await N()){m.value=!0;const o=q(M,a.data.token,a.web3),n=await o.methods.removeOwner(p.value,r.value.owner,r.value.confirmNumber).encodeABI(),d={destination:a.data.token,value:"0",data:n};o.methods.submitTransaction(d.destination,d.value,d.data).send({from:a.connectedWallet.address}).then(()=>{F("refresh-data")}).catch(b=>{console.error(b)}).finally(()=>{m.value=!1,v()})}},g=async()=>{const t=a.data.owners,o=t.findIndex(d=>d===r.value.owner),n=parseInt(o)-1;n>=0?p.value=t[n]:p.value=Q},v=()=>{w.value=!1};return W(()=>w.value,t=>{F("update:visible",t)}),W(()=>a.visible,t=>{w.value=t}),W(()=>a.data,t=>{m.value=!0,t?(r.value.owner=a.owner,_.value=parseInt(t.ownerCount)-1,r.value.confirmNumber=parseInt(t.threshold)<=_.value?parseInt(t.threshold):_.value):r.value=V,g(),m.value=!1}),W(()=>a.owner,t=>{r.value.owner=t,g()}),(t,o)=>{const n=u("el-input"),d=u("el-col"),b=u("el-row"),I=u("el-form-item"),S=u("el-divider"),C=u("el-option"),T=u("el-select"),A=u("el-form"),f=u("el-button"),y=u("el-dialog");return x(),E(y,{modelValue:w.value,"onUpdate:modelValue":o[2]||(o[2]=j=>w.value=j),title:i(s)("wallet.removeOwner"),width:"90%",draggable:"","close-on-click-modal":!1,"before-close":v},{footer:e(()=>[l(f,{loading:m.value,onClick:v},{default:e(()=>[O(h(i(s)("wallet.btnCancel")),1)]),_:1},8,["loading"]),l(f,{loading:m.value,type:"primary",onClick:k},{default:e(()=>[O(h(i(s)("wallet.btnSubmit")),1)]),_:1},8,["loading"])]),default:e(()=>[l(A,{ref_key:"walletFormRef",ref:R,model:r.value,"label-width":"100px",class:"demo-ruleForm","hide-required-asterisk":!0,"label-position":"top"},{default:e(()=>[l(I,{prop:"owner",label:i(s)("wallet.owners"),style:{width:"100%"},rules:[{validator:D,trigger:"blur"}]},{default:e(()=>[l(b,{gutter:20,style:{width:"100%"}},{default:e(()=>[l(d,{span:24},{default:e(()=>[l(n,{modelValue:r.value.owner,"onUpdate:modelValue":o[0]||(o[0]=j=>r.value.owner=j),disabled:!0},null,8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["label","rules"]),l(S),l(I,{prop:"confirmNumber",label:i(s)("wallet.confirmNumber"),style:{width:"100%"},rules:[{required:!0,message:i(s)("wallet.please select confirm number"),trigger:"change"}]},{default:e(()=>[l(b,{gutter:20,style:{width:"100%"}},{default:e(()=>[l(d,{xs:8,md:2},{default:e(()=>[l(T,{modelValue:r.value.confirmNumber,"onUpdate:modelValue":o[1]||(o[1]=j=>r.value.confirmNumber=j)},{default:e(()=>[(x(!0),P(H,null,z(_.value,j=>(x(),E(C,{key:j,label:j,value:j},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),l(d,{xs:1,md:1},{default:e(()=>[O("/")]),_:1}),l(d,{xs:8,md:2},{default:e(()=>[O(h(_.value),1)]),_:1}),l(d,{xs:7,md:19})]),_:1})]),_:1},8,["label","rules"])]),_:1},8,["model"])]),_:1},8,["modelValue","title"])}}}),te={style:{display:"flex","align-items":"left"}},ae={style:{display:"flex","align-items":"left"}},oe={style:{display:"flex","align-items":"left"}},ne={style:{display:"flex","align-items":"left"}},re=L({name:"WalletTable"}),me=L({...re,props:{data:{type:Object,default:()=>[]},connectedWallet:{type:Object,default:null},web3:{type:Object,default:null},currentWallet:{type:String,default:""}},emits:["refresh-wallet-list","change-wallet"],setup(B,{emit:F}){const a=B,m=c(!1),w=c([]),_=c(null),V=c(""),R=c(!1),r=c(!1),p=c(!1),D=c(!1),N=()=>{F("refresh-wallet-list")},k=n=>{F("change-wallet",n)},g=n=>{_.value=n,R.value=!0},v=n=>{_.value=n,r.value=!0},t=(n,d)=>{_.value=n,V.value=d,p.value=!0},o=(n,d)=>{_.value=n,V.value=d,D.value=!0};return W(()=>a.data,n=>{m.value=!0,w.value=n,m.value=!1}),X(()=>{a.data&&a.connectedWallet&&a.web3&&a.currentWallet&&(w.value=a.data)}),(n,d)=>{const b=u("el-table-column"),I=u("IconifyIconOffline"),S=u("el-dropdown-item"),C=u("el-dropdown-menu"),T=u("el-dropdown"),A=u("el-table");return x(),P("div",null,[l(A,{data:w.value,style:{width:"100%"}},{default:e(()=>[l(b,{type:"expand"},{default:e(f=>[l(A,{data:f.row.owners,stripe:"",style:{width:"100%"}},{default:e(()=>[l(b,{label:i(s)("wallet.address")},{default:e(y=>[U("div",te,[U("span",null,h(y.row),1)])]),_:1},8,["label"]),l(b,{label:i(s)("wallet.operation")},{default:e(y=>[l(T,{trigger:"click"},{dropdown:e(()=>[l(C,null,{default:e(()=>[l(S,{onClick:j=>t(f.row,y.row)},{default:e(()=>[O(h(i(s)("wallet.btnSwapOwner")),1)]),_:2},1032,["onClick"]),f.row.owners.length>1?(x(),E(S,{key:0,onClick:j=>o(f.row,y.row),divided:""},{default:e(()=>[O(h(i(s)("wallet.btnDelete")),1)]),_:2},1032,["onClick"])):$("",!0)]),_:2},1024)]),default:e(()=>[l(I,{icon:i(K),class:"text-[24px]"},null,8,["icon"])]),_:2},1024)]),_:2},1032,["label"])]),_:2},1032,["data"])]),_:1}),l(b,{label:i(s)("wallet.address")},{default:e(f=>[U("div",ae,[U("span",null,h(f.row.token),1)])]),_:1},8,["label"]),l(b,{label:i(s)("wallet.name")},{default:e(f=>[U("div",oe,[U("span",null,h(f.row.name),1)])]),_:1},8,["label"]),l(b,{label:i(s)("wallet.confirmNumber")+"/"+i(s)("wallet.ownerCount")},{default:e(f=>[U("div",ne,[U("span",null,h(f.row.threshold)+" / "+h(f.row.ownerCount),1)])]),_:1},8,["label"]),l(b,{label:i(s)("wallet.operation")},{default:e(f=>[l(T,{trigger:"click"},{dropdown:e(()=>[l(C,null,{default:e(()=>[l(S,{disabled:f.row.token.toLowerCase()===a.currentWallet.toLowerCase(),onClick:y=>k(f.row)},{default:e(()=>[O(h(f.row.token.toLowerCase()===a.currentWallet.toLowerCase()?i(s)("wallet.btnSelectedWallet"):i(s)("wallet.btnChangeWallet")),1)]),_:2},1032,["disabled","onClick"]),l(S,{onClick:y=>v(f.row),divided:""},{default:e(()=>[O(h(i(s)("wallet.btnAddOwner")),1)]),_:2},1032,["onClick"]),l(S,{onClick:y=>g(f.row)},{default:e(()=>[O(h(i(s)("wallet.btnChangeThreshold")),1)]),_:2},1032,["onClick"])]),_:2},1024)]),default:e(()=>[l(I,{icon:i(K),class:"text-[24px]"},null,8,["icon"])]),_:2},1024)]),_:1},8,["label"])]),_:1},8,["data"]),a.web3?(x(),E(Z,{key:0,visible:r.value,"onUpdate:visible":d[0]||(d[0]=f=>r.value=f),data:_.value,connectedWallet:a.connectedWallet,web3:a.web3,onRefreshData:N},null,8,["visible","data","connectedWallet","web3"])):$("",!0),a.web3?(x(),E(Y,{key:1,visible:R.value,"onUpdate:visible":d[1]||(d[1]=f=>R.value=f),data:_.value,connectedWallet:a.connectedWallet,web3:a.web3,onRefreshData:N},null,8,["visible","data","connectedWallet","web3"])):$("",!0),a.web3?(x(),E(ee,{key:2,visible:p.value,"onUpdate:visible":d[2]||(d[2]=f=>p.value=f),data:_.value,connectedWallet:a.connectedWallet,web3:a.web3,owner:V.value,onRefreshData:N},null,8,["visible","data","connectedWallet","web3","owner"])):$("",!0),a.web3?(x(),E(le,{key:3,visible:D.value,"onUpdate:visible":d[3]||(d[3]=f=>D.value=f),data:_.value,connectedWallet:a.connectedWallet,web3:a.web3,owner:V.value,onRefreshData:N},null,8,["visible","data","connectedWallet","web3","owner"])):$("",!0)])}}});export{me as _};

import{t as s}from"./___vite-browser-external_commonjs-proxy-1cc6769e.js";import{g as q,M as z,S as K}from"./web3-125a0c04.js";import{x as L,r as w,w as W,a7 as i,y as V,H as I,I as e,P as l,M as y,O as h,u as c,z as M,a0 as P,F as H,o as Q,A as T,L as U}from"./runtime-core.esm-bundler-c80a0204.js";import{c as G,i as J}from"./addresses-e86418e1.js";const X=L({__name:"ChangeThreshold",props:{visible:{type:Boolean,default:!1},data:{type:Object,default:()=>null},connectedWallet:{type:Object,default:null},web3:{type:Object,default:null}},emits:["update:visible","refresh-data"],setup(B,{emit:F}){const a=B,f=w(!1),m=w(!1),_=w(0),O={confirmNumber:1},R=w(),r=w(O),v=async()=>await R.value.validate(g=>!!g),A=async()=>{if(await v()){f.value=!0;const g=q(z,a.data.token,a.web3),p=await g.methods.changeThreshold(r.value.confirmNumber).encodeABI(),t={destination:a.data.token,value:"0",data:p};g.methods.submitTransaction(t.destination,t.value,t.data).send({from:a.connectedWallet.address}).then(()=>{F("refresh-data")}).catch(n=>{console.error(n)}).finally(()=>{f.value=!1,N()})}},N=()=>{m.value=!1};return W(()=>m.value,k=>{F("update:visible",k)}),W(()=>a.visible,k=>{m.value=k}),W(()=>a.data,k=>{f.value=!0,k?(_.value=parseInt(k.ownerCount),r.value.confirmNumber=k.threshold):r.value=O,f.value=!1}),(k,g)=>{const p=i("el-option"),t=i("el-select"),n=i("el-col"),o=i("el-row"),u=i("el-form-item"),b=i("el-form"),C=i("el-button"),j=i("el-dialog");return V(),I(j,{modelValue:m.value,"onUpdate:modelValue":g[1]||(g[1]=d=>m.value=d),title:c(s)("wallet.changeThreshold"),width:"90%",draggable:"","close-on-click-modal":!1,"before-close":N},{footer:e(()=>[l(C,{loading:f.value,onClick:N},{default:e(()=>[y(h(c(s)("wallet.btnCancel")),1)]),_:1},8,["loading"]),l(C,{loading:f.value,type:"primary",onClick:A},{default:e(()=>[y(h(c(s)("wallet.btnSubmit")),1)]),_:1},8,["loading"])]),default:e(()=>[l(b,{ref_key:"walletFormRef",ref:R,model:r.value,"label-width":"100px",class:"demo-ruleForm","hide-required-asterisk":!0},{default:e(()=>[l(u,{prop:"confirmNumber",label:c(s)("wallet.confirmNumber"),style:{width:"100%"},rules:[{required:!0,message:c(s)("wallet.please select confirm number"),trigger:"change"}]},{default:e(()=>[l(o,{gutter:20,style:{width:"100%"}},{default:e(()=>[l(n,{span:2},{default:e(()=>[l(t,{modelValue:r.value.confirmNumber,"onUpdate:modelValue":g[0]||(g[0]=d=>r.value.confirmNumber=d)},{default:e(()=>[(V(!0),M(H,null,P(_.value,d=>(V(),I(p,{key:d,label:d,value:d},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),l(n,{span:1},{default:e(()=>[y("/")]),_:1}),l(n,{span:2},{default:e(()=>[y(h(_.value),1)]),_:1}),l(n,{span:19})]),_:1})]),_:1},8,["label","rules"])]),_:1},8,["model"])]),_:1},8,["modelValue","title"])}}}),Y=L({__name:"AddOwner",props:{visible:{type:Boolean,default:!1},data:{type:Object,default:()=>null},connectedWallet:{type:Object,default:null},web3:{type:Object,default:null}},emits:["update:visible","refresh-data"],setup(B,{emit:F}){const a=B,f=w(!1),m=w(!1),_=w([]),O=w(0),R={owner:"",confirmNumber:1},r=w(),v=w(R),A=(p,t,n)=>{t===""?n(new Error(s("wallet.please input wallet address"))):(v.value.owner=G(v.value.owner),J(v.value.owner)?_.value.filter(u=>u.toLowerCase()===t.toLowerCase()).length>0?n(new Error(s("wallet.owner is already added"))):n():n(new Error(s("wallet.invalid wallet address"))))},N=async()=>await r.value.validate(t=>!!t),k=async()=>{if(await N()){f.value=!0;const t=q(z,a.data.token,a.web3),n=await t.methods.addOwnerWithThreshold(v.value.owner,v.value.confirmNumber).encodeABI(),o={destination:a.data.token,value:"0",data:n};t.methods.submitTransaction(o.destination,o.value,o.data).send({from:a.connectedWallet.address}).then(()=>{F("refresh-data")}).catch(u=>{console.error(u)}).finally(()=>{f.value=!1,g()})}},g=()=>{m.value=!1};return W(()=>m.value,p=>{F("update:visible",p)}),W(()=>a.visible,p=>{m.value=p}),W(()=>a.data,p=>{f.value=!0,p?(_.value=p.owners,O.value=parseInt(p.ownerCount)+1,v.value.confirmNumber=p.threshold):v.value=R,f.value=!1}),(p,t)=>{const n=i("el-input"),o=i("el-col"),u=i("el-row"),b=i("el-form-item"),C=i("el-divider"),j=i("el-option"),d=i("el-select"),x=i("el-form"),S=i("el-button"),$=i("el-dialog");return V(),I($,{modelValue:m.value,"onUpdate:modelValue":t[2]||(t[2]=E=>m.value=E),title:c(s)("wallet.addOwner"),width:"90%",draggable:"","close-on-click-modal":!1,"before-close":g},{footer:e(()=>[l(S,{loading:f.value,onClick:g},{default:e(()=>[y(h(c(s)("wallet.btnCancel")),1)]),_:1},8,["loading"]),l(S,{loading:f.value,type:"primary",onClick:k},{default:e(()=>[y(h(c(s)("wallet.btnSubmit")),1)]),_:1},8,["loading"])]),default:e(()=>[l(x,{ref_key:"walletFormRef",ref:r,model:v.value,"label-width":"100px",class:"demo-ruleForm","hide-required-asterisk":!0},{default:e(()=>[l(b,{prop:"owner",label:c(s)("wallet.owners"),style:{width:"100%"},rules:[{validator:A,trigger:"blur"}]},{default:e(()=>[l(u,{gutter:20,style:{width:"100%"}},{default:e(()=>[l(o,{span:24},{default:e(()=>[l(n,{modelValue:v.value.owner,"onUpdate:modelValue":t[0]||(t[0]=E=>v.value.owner=E)},null,8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["label","rules"]),l(C),l(b,{prop:"confirmNumber",label:c(s)("wallet.confirmNumber"),style:{width:"100%"},rules:[{required:!0,message:c(s)("wallet.please select confirm number"),trigger:"change"}]},{default:e(()=>[l(u,{gutter:20,style:{width:"100%"}},{default:e(()=>[l(o,{span:2},{default:e(()=>[l(d,{modelValue:v.value.confirmNumber,"onUpdate:modelValue":t[1]||(t[1]=E=>v.value.confirmNumber=E)},{default:e(()=>[(V(!0),M(H,null,P(O.value,E=>(V(),I(j,{key:E,label:E,value:E},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),l(o,{span:1},{default:e(()=>[y("/")]),_:1}),l(o,{span:2},{default:e(()=>[y(h(O.value),1)]),_:1}),l(o,{span:19})]),_:1})]),_:1},8,["label","rules"])]),_:1},8,["model"])]),_:1},8,["modelValue","title"])}}}),Z=L({__name:"SwapOwner",props:{visible:{type:Boolean,default:!1},data:{type:Object,default:()=>null},connectedWallet:{type:Object,default:null},web3:{type:Object,default:null},owner:{type:String,default:""}},emits:["update:visible","refresh-data"],setup(B,{emit:F}){const a=B,f=w(!1),m=w(!1),_=w([]),O={owner:"",newOwner:""},R=w(),r=w(O),v=w(""),A=(t,n,o)=>{n===""?o(new Error(s("wallet.please input wallet address"))):(r.value.newOwner=G(r.value.newOwner),J(r.value.newOwner)?_.value.filter(b=>b.toLowerCase()===n.toLowerCase()).length>0?o(new Error(s("wallet.owner is already added"))):o():o(new Error(s("wallet.invalid wallet address"))))},N=async()=>await R.value.validate(n=>!!n),k=async()=>{if(await N()){f.value=!0;const n=q(z,a.data.token,a.web3),o=await n.methods.swapOwner(v.value,r.value.owner,r.value.newOwner).encodeABI(),u={destination:a.data.token,value:"0",data:o};n.methods.submitTransaction(u.destination,u.value,u.data).send({from:a.connectedWallet.address}).then(()=>{F("refresh-data")}).catch(b=>{console.error(b)}).finally(()=>{f.value=!1,p()})}},g=async()=>{const t=a.data.owners,n=t.findIndex(u=>u===r.value.owner),o=parseInt(n)-1;o>=0?v.value=t[o]:v.value=K},p=()=>{m.value=!1};return W(()=>m.value,t=>{F("update:visible",t)}),W(()=>a.visible,t=>{m.value=t}),W(()=>a.data,t=>{f.value=!0,t?(_.value=t.owners,r.value.owner=a.owner):r.value=O,g(),f.value=!1}),W(()=>a.owner,t=>{r.value.owner=t,g()}),(t,n)=>{const o=i("el-input"),u=i("el-col"),b=i("el-row"),C=i("el-form-item"),j=i("el-form"),d=i("el-button"),x=i("el-dialog");return V(),I(x,{modelValue:m.value,"onUpdate:modelValue":n[2]||(n[2]=S=>m.value=S),title:c(s)("wallet.swapOwner"),width:"90%",draggable:"","close-on-click-modal":!1,"before-close":p},{footer:e(()=>[l(d,{loading:f.value,onClick:p},{default:e(()=>[y(h(c(s)("wallet.btnCancel")),1)]),_:1},8,["loading"]),l(d,{loading:f.value,type:"primary",onClick:k},{default:e(()=>[y(h(c(s)("wallet.btnSubmit")),1)]),_:1},8,["loading"])]),default:e(()=>[l(j,{ref_key:"walletFormRef",ref:R,model:r.value,"label-width":"100px",class:"demo-ruleForm","hide-required-asterisk":!0},{default:e(()=>[l(C,{prop:"owner",label:c(s)("wallet.oldOwner"),style:{width:"100%"},rules:[{required:!0,message:c(s)("wallet.please input wallet address"),trigger:"blur"}]},{default:e(()=>[l(b,{gutter:20,style:{width:"100%"}},{default:e(()=>[l(u,{span:24},{default:e(()=>[l(o,{modelValue:r.value.owner,"onUpdate:modelValue":n[0]||(n[0]=S=>r.value.owner=S),disabled:!0},null,8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["label","rules"]),l(C,{prop:"newOwner",label:c(s)("wallet.newOwner"),style:{width:"100%"},rules:[{validator:A,trigger:"blur"}]},{default:e(()=>[l(b,{gutter:20,style:{width:"100%"}},{default:e(()=>[l(u,{span:24},{default:e(()=>[l(o,{modelValue:r.value.newOwner,"onUpdate:modelValue":n[1]||(n[1]=S=>r.value.newOwner=S)},null,8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["label","rules"])]),_:1},8,["model"])]),_:1},8,["modelValue","title"])}}}),ee=L({__name:"RemoveOwner",props:{visible:{type:Boolean,default:!1},data:{type:Object,default:()=>null},connectedWallet:{type:Object,default:null},web3:{type:Object,default:null},owner:{type:String,default:""}},emits:["update:visible","refresh-data"],setup(B,{emit:F}){const a=B,f=w(!1),m=w(!1),_=w(0),O={owner:"",confirmNumber:1},R=w(),r=w(O),v=w(""),A=(t,n,o)=>{n===""?o(new Error(s("wallet.please input wallet address"))):(r.value.owner=G(r.value.owner),J(r.value.owner)?o():o(new Error(s("wallet.invalid wallet address"))))},N=async()=>await R.value.validate(n=>!!n),k=async()=>{if(await N()){f.value=!0;const n=q(z,a.data.token,a.web3),o=await n.methods.removeOwner(v.value,r.value.owner,r.value.confirmNumber).encodeABI(),u={destination:a.data.token,value:"0",data:o};n.methods.submitTransaction(u.destination,u.value,u.data).send({from:a.connectedWallet.address}).then(()=>{F("refresh-data")}).catch(b=>{console.error(b)}).finally(()=>{f.value=!1,p()})}},g=async()=>{const t=a.data.owners,n=t.findIndex(u=>u===r.value.owner),o=parseInt(n)-1;o>=0?v.value=t[o]:v.value=K},p=()=>{m.value=!1};return W(()=>m.value,t=>{F("update:visible",t)}),W(()=>a.visible,t=>{m.value=t}),W(()=>a.data,t=>{f.value=!0,t?(r.value.owner=a.owner,_.value=parseInt(t.ownerCount)-1,r.value.confirmNumber=parseInt(t.threshold)<=_.value?parseInt(t.threshold):_.value):r.value=O,g(),f.value=!1}),W(()=>a.owner,t=>{r.value.owner=t,g()}),(t,n)=>{const o=i("el-input"),u=i("el-col"),b=i("el-row"),C=i("el-form-item"),j=i("el-divider"),d=i("el-option"),x=i("el-select"),S=i("el-form"),$=i("el-button"),E=i("el-dialog");return V(),I(E,{modelValue:m.value,"onUpdate:modelValue":n[2]||(n[2]=D=>m.value=D),title:c(s)("wallet.removeOwner"),width:"90%",draggable:"","close-on-click-modal":!1,"before-close":p},{footer:e(()=>[l($,{loading:f.value,onClick:p},{default:e(()=>[y(h(c(s)("wallet.btnCancel")),1)]),_:1},8,["loading"]),l($,{loading:f.value,type:"primary",onClick:k},{default:e(()=>[y(h(c(s)("wallet.btnSubmit")),1)]),_:1},8,["loading"])]),default:e(()=>[l(S,{ref_key:"walletFormRef",ref:R,model:r.value,"label-width":"100px",class:"demo-ruleForm","hide-required-asterisk":!0},{default:e(()=>[l(C,{prop:"owner",label:c(s)("wallet.owners"),style:{width:"100%"},rules:[{validator:A,trigger:"blur"}]},{default:e(()=>[l(b,{gutter:20,style:{width:"100%"}},{default:e(()=>[l(u,{span:24},{default:e(()=>[l(o,{modelValue:r.value.owner,"onUpdate:modelValue":n[0]||(n[0]=D=>r.value.owner=D),disabled:!0},null,8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["label","rules"]),l(j),l(C,{prop:"confirmNumber",label:c(s)("wallet.confirmNumber"),style:{width:"100%"},rules:[{required:!0,message:c(s)("wallet.please select confirm number"),trigger:"change"}]},{default:e(()=>[l(b,{gutter:20,style:{width:"100%"}},{default:e(()=>[l(u,{span:2},{default:e(()=>[l(x,{modelValue:r.value.confirmNumber,"onUpdate:modelValue":n[1]||(n[1]=D=>r.value.confirmNumber=D)},{default:e(()=>[(V(!0),M(H,null,P(_.value,D=>(V(),I(d,{key:D,label:D,value:D},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),l(u,{span:1},{default:e(()=>[y("/")]),_:1}),l(u,{span:2},{default:e(()=>[y(h(_.value),1)]),_:1}),l(u,{span:19})]),_:1})]),_:1},8,["label","rules"])]),_:1},8,["model"])]),_:1},8,["modelValue","title"])}}}),le={style:{display:"flex","align-items":"left"}},te={style:{display:"flex","align-items":"left"}},ae={style:{display:"flex","align-items":"left"}},ne={style:{display:"flex","align-items":"left"}},oe=L({name:"WalletTable"}),ie=L({...oe,props:{data:{type:Object,default:()=>[]},connectedWallet:{type:Object,default:null},web3:{type:Object,default:null},currentWallet:{type:String,default:""}},emits:["refresh-wallet-list","change-wallet"],setup(B,{emit:F}){const a=B,f=w(!1),m=w([]),_=w(null),O=w(""),R=w(!1),r=w(!1),v=w(!1),A=w(!1),N=()=>{F("refresh-wallet-list")},k=o=>{F("change-wallet",o)},g=o=>{_.value=o,R.value=!0},p=o=>{_.value=o,r.value=!0},t=(o,u)=>{_.value=o,O.value=u,v.value=!0},n=(o,u)=>{_.value=o,O.value=u,A.value=!0};return W(()=>a.data,o=>{f.value=!0,m.value=o,f.value=!1}),Q(()=>{a.data&&a.connectedWallet&&a.web3&&a.currentWallet&&(m.value=a.data)}),(o,u)=>{const b=i("el-table-column"),C=i("el-button"),j=i("el-table");return V(),M("div",null,[l(j,{data:m.value,style:{width:"100%"}},{default:e(()=>[l(b,{type:"expand"},{default:e(d=>[l(j,{data:d.row.owners,style:{width:"100%"}},{default:e(()=>[l(b,{label:c(s)("wallet.address")},{default:e(x=>[T("div",le,[T("span",null,h(x.row),1)])]),_:1},8,["label"]),l(b,{label:c(s)("wallet.operation")},{default:e(x=>[l(C,{type:"primary",size:"small",onClick:S=>t(d.row,x.row)},{default:e(()=>[y(h(c(s)("wallet.btnSwapOwner")),1)]),_:2},1032,["onClick"]),d.row.owners.length>1?(V(),I(C,{key:0,type:"danger",size:"small",onClick:S=>n(d.row,x.row)},{default:e(()=>[y(h(c(s)("wallet.btnDelete")),1)]),_:2},1032,["onClick"])):U("",!0)]),_:2},1032,["label"])]),_:2},1032,["data"])]),_:1}),l(b,{label:c(s)("wallet.address")},{default:e(d=>[T("div",te,[T("span",null,h(d.row.token),1)])]),_:1},8,["label"]),l(b,{label:c(s)("wallet.name")},{default:e(d=>[T("div",ae,[T("span",null,h(d.row.name),1)])]),_:1},8,["label"]),l(b,{label:c(s)("wallet.confirmNumber")+"/"+c(s)("wallet.ownerCount")},{default:e(d=>[T("div",ne,[T("span",null,h(d.row.threshold)+" / "+h(d.row.ownerCount),1)])]),_:1},8,["label"]),l(b,{label:c(s)("wallet.operation"),fixed:"right",width:"400"},{default:e(d=>[l(C,{size:"small",type:"primary",disabled:d.row.token.toLowerCase()===a.currentWallet.toLowerCase(),onClick:x=>k(d.row)},{default:e(()=>[y(h(d.row.token.toLowerCase()===a.currentWallet.toLowerCase()?c(s)("wallet.btnSelectedWallet"):c(s)("wallet.btnChangeWallet")),1)]),_:2},1032,["disabled","onClick"]),d.row.confirmStatus?U("",!0):(V(),I(C,{key:0,type:"primary",size:"small",onClick:x=>p(d.row)},{default:e(()=>[y(h(c(s)("wallet.btnAddOwner")),1)]),_:2},1032,["onClick"])),l(C,{type:"primary",size:"small",onClick:x=>g(d.row)},{default:e(()=>[y(h(c(s)("wallet.btnChangeThreshold")),1)]),_:2},1032,["onClick"])]),_:1},8,["label"])]),_:1},8,["data"]),a.web3?(V(),I(Y,{key:0,visible:r.value,"onUpdate:visible":u[0]||(u[0]=d=>r.value=d),data:_.value,connectedWallet:a.connectedWallet,web3:a.web3,onRefreshData:N},null,8,["visible","data","connectedWallet","web3"])):U("",!0),a.web3?(V(),I(X,{key:1,visible:R.value,"onUpdate:visible":u[1]||(u[1]=d=>R.value=d),data:_.value,connectedWallet:a.connectedWallet,web3:a.web3,onRefreshData:N},null,8,["visible","data","connectedWallet","web3"])):U("",!0),a.web3?(V(),I(Z,{key:2,visible:v.value,"onUpdate:visible":u[2]||(u[2]=d=>v.value=d),data:_.value,connectedWallet:a.connectedWallet,web3:a.web3,owner:O.value,onRefreshData:N},null,8,["visible","data","connectedWallet","web3","owner"])):U("",!0),a.web3?(V(),I(ee,{key:3,visible:A.value,"onUpdate:visible":u[3]||(u[3]=d=>A.value=d),data:_.value,connectedWallet:a.connectedWallet,web3:a.web3,owner:O.value,onRefreshData:N},null,8,["visible","data","connectedWallet","web3","owner"])):U("",!0)])}}});export{ie as _};

import{E as o}from"./___vite-browser-external_commonjs-proxy-7f1f402a.js";import{g as A,M as E,a as S}from"./web3-bdfc4e9c.js";import{g as M,d as P,a as V,c as R}from"./getLogs-a8100a6a.js";import{B as j}from"./ButtonOfCopy-7cfa85d9.js";import{i as z}from"./chains-68c757ba.js";import{x as L,r as B,o as J,a7 as u,aa as q,y as s,z as f,J as G,H as m,I as r,P as _,A as i,M as d,O as e,u as a,F as D,a0 as H,L as p}from"./runtime-core.esm-bundler-c80a0204.js";const K={style:{"word-wrap":"break-word"}},Q={key:0},U={key:1},X={style:{"word-wrap":"break-word"}},Y={class:"block"},Z={style:{"word-wrap":"break-word"}},$={style:{"word-wrap":"break-word"}},tt={style:{display:"flex","align-items":"left"}},et={style:{display:"flex","align-items":"left"}},at=L({name:"TransactionsHistory"}),ct=L({...at,props:{connectedWallet:{type:Object,default:null},web3:{type:Object,default:null},currentWallet:{type:String,default:""}},setup(F){const c=F,k=B(!1),b=B([]),N=B(null),O=async()=>{k.value=!0;const y=A(E,c.currentWallet,c.web3);b.value=[];const W=await y.methods.getTransactionIds(1).call(),I=await y.methods.getTransactionIds(2).call(),x=W.concat(I).map(async v=>{const l=await y.methods.getTransaction(v).call(),h=await y.methods.getTransactionConfirmationStatus(v,c.connectedWallet.address).call(),T=await c.web3.eth.getChainId();N.value=z(T);const C=await M(y,l),t={id:v,destination:l.to,tokenSymbol:"",value:null,data:null,confirmations:l.confirmations,revokes:l.revokes,executeState:l.state,confirmStatus:h,type:1,methodName:"",events:C};let n=null;l.to.toLowerCase()===c.currentWallet.toLowerCase()?n=P(l):n=V(l,N,c.web3);const g={...t,...n};b.value.push(g)});await Promise.all(x),b.value.sort(R("id")),k.value=!1};return J(()=>{c.connectedWallet&&c.web3&&c.currentWallet&&O()}),(y,W)=>{const I=u("el-divider"),w=u("el-tag"),x=u("el-card"),v=u("el-timeline-item"),l=u("el-timeline"),h=u("el-table-column"),T=u("el-table"),C=q("loading");return s(),f("div",null,[G((s(),m(T,{data:b.value,style:{width:"100%"}},{default:r(()=>[_(h,{type:"expand"},{default:r(t=>[i("p",K,[d(e(a(o)("transaction.destination"))+": ",1),_(j,{text:t.row.destination},null,8,["text"])]),t.row.type==2?(s(),f("div",Q,[(s(!0),f(D,null,H(t.row.data,(n,g)=>(s(),f("p",{style:{"word-wrap":"break-word"},key:g},e(a(o)("transaction."+n.name))+": "+e(n.value),1))),128))])):p("",!0),t.row.type==1?(s(),f("div",U,[i("p",X,e(a(o)("transaction.amount"))+": "+e(t.row.value)+" "+e(t.row.tokenSymbol),1)])):p("",!0),_(I),i("div",Y,[t.row.events.length>0?(s(),m(l,{key:0},{default:r(()=>[(s(!0),f(D,null,H(t.row.events,(n,g)=>(s(),m(v,{key:g,timestamp:n.createTime,placement:"top"},{default:r(()=>[_(x,null,{default:r(()=>[i("h4",null,[d(e(a(o)("transaction.eventName"))+": ",1),_(w,{type:a(S)[n.eventName].tagType},{default:r(()=>[d(e(a(S)[n.eventName].name?a(o)("transaction."+a(S)[n.eventName].name):""),1)]),_:2},1032,["type"])]),i("p",Z,[d(e(a(o)("transaction.eventFrom"))+": ",1),i("span",null,e(n.from),1)]),i("p",$,[d(e(a(o)("transaction.eventTransactionHash"))+": ",1),i("span",null,e(n.transactionHash),1)])]),_:2},1024)]),_:2},1032,["timestamp"]))),128))]),_:2},1024)):p("",!0)])]),_:1}),_(h,{label:a(o)("transaction.type")},{default:r(t=>[i("div",tt,[t.row.type==1?(s(),m(w,{key:0,type:"success"},{default:r(()=>[d(e(a(o)("transaction."+t.row.methodName)),1)]),_:2},1024)):p("",!0),t.row.type==2?(s(),m(w,{key:1,type:"warning"},{default:r(()=>[d(e(a(o)("transaction."+t.row.methodName)),1)]),_:2},1024)):p("",!0)])]),_:1},8,["label"]),_(h,{label:a(o)("transaction.status")},{default:r(t=>[i("div",et,[t.row.executeState==1?(s(),m(w,{key:0,type:"success"},{default:r(()=>[d(e(a(o)("transaction.statusSuccess")),1)]),_:1})):p("",!0),t.row.executeState==2?(s(),m(w,{key:1,type:"danger"},{default:r(()=>[d(e(a(o)("transaction.statusRevoke")),1)]),_:1})):p("",!0)])]),_:1},8,["label"])]),_:1},8,["data"])),[[C,k.value]])])}}});export{ct as _};

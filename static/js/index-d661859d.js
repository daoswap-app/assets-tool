import{t as o}from"./i18n-c677edf9.js";import{u as S}from"./web3Modal-7484dbf1.js";import{f as N}from"./formatters-607f9df1.js";import{c as Q,i as X}from"./addresses-c9475005.js";import{u as C,g as H,M as Y,e as Z}from"./web3-ed59ec2e.js";import{x as L,r as d,o as j,w as F,a7 as i,aa as q,y as w,H as x,I as e,J as E,M as W,O as y,u as r,P as t,z,a0 as ee,F as te,A as f}from"./runtime-core.esm-bundler-c80a0204.js";import"./__vite-browser-external-c2c4480c.js";import"./vue-i18n.runtime.esm-bundler-d653d868.js";import"./index-dd8ad2b3.js";import"./preload-helper-101896b7.js";import"./vue-router-935545c9.js";import"./___vite-browser-external_commonjs-proxy-66fe83c2.js";import"./utils-6de8de71.js";import"./index-aa19b975.js";const ae=L({__name:"SendTransaction",props:{visible:{type:Boolean,default:!1},data:{type:Object,default:()=>null},tokenList:{type:Object,default:()=>[]}},emits:["update:visible"],setup(R,{emit:T}){const _=R,m=d(!1),c=d(!1),g=d(""),h=d(null),k=d(null),D={sendAddress:"",recipientAddress:"0x9b1d0c9c1aE96011776e6786b4Efe884665918D2",assetToken:"",amount:"0.001"},M=d(),l=d(D);j(()=>{g.value=C().getWallet,h.value=S().getWallet,k.value=S().getWeb3,l.value.sendAddress=g.value});const b=(n,s,a)=>{s===""?a(new Error(o("transaction.please input recipient address"))):(l.value.recipientAddress=Q(l.value.recipientAddress),X(l.value.recipientAddress)?a():a(new Error(o("transaction.invalid recipient address"))))},p=async()=>await M.value.validate(n=>!!n),A=async()=>{await p()&&(m.value=!0,H(Y,C().getWallet,k.value).methods.submitTransaction(l.value.recipientAddress,Z(l.value.amount,k.value),[]).send({from:h.value.address}).then(a=>{console.info(a)}).catch(a=>{console.error(a)}).finally(()=>{m.value=!1,v()}))},v=()=>{c.value=!1};return F(()=>c.value,n=>{T("update:visible",n)}),F(()=>_.visible,n=>{c.value=n}),F(()=>_.data,n=>{l.value.assetToken=n?n.token:""}),(n,s)=>{const a=i("el-col"),V=i("el-row"),B=i("el-form-item"),$=i("el-divider"),I=i("el-input"),J=i("el-option"),P=i("el-select"),G=i("el-form"),O=i("el-button"),K=i("el-dialog"),U=q("loading");return w(),x(K,{modelValue:c.value,"onUpdate:modelValue":s[3]||(s[3]=u=>c.value=u),title:r(o)("transaction.sendTokens"),width:"80%",draggable:"","close-on-click-modal":!1,"before-close":v},{footer:e(()=>[E((w(),x(O,{onClick:v},{default:e(()=>[W(y(r(o)("wallet.btnCancel")),1)]),_:1})),[[U,m.value]]),E((w(),x(O,{type:"primary",onClick:A},{default:e(()=>[W(y(r(o)("wallet.btnSubmit")),1)]),_:1})),[[U,m.value]])]),default:e(()=>[t(G,{ref_key:"transactionFormRef",ref:M,model:l.value,"label-width":"100px",class:"demo-ruleForm","hide-required-asterisk":!0},{default:e(()=>[t(B,{prop:"sendAddress",label:r(o)("transaction.sendAddress"),style:{width:"100%"}},{default:e(()=>[t(V,{gutter:20,style:{width:"100%"}},{default:e(()=>[t(a,{span:24},{default:e(()=>[W(y(l.value.sendAddress),1)]),_:1})]),_:1})]),_:1},8,["label"]),t($),t(B,{prop:"recipientAddress",label:r(o)("transaction.recipientAddress"),style:{width:"100%"},rules:[{validator:b,trigger:"blur"}]},{default:e(()=>[t(V,{gutter:20,style:{width:"100%"}},{default:e(()=>[t(a,{span:24},{default:e(()=>[t(I,{modelValue:l.value.recipientAddress,"onUpdate:modelValue":s[0]||(s[0]=u=>l.value.recipientAddress=u)},null,8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["label","rules"]),t(B,{prop:"assetToken",label:r(o)("transaction.assetToken"),style:{width:"100%"}},{default:e(()=>[t(V,{gutter:20,style:{width:"100%"}},{default:e(()=>[t(a,{span:24},{default:e(()=>[t(P,{modelValue:l.value.assetToken,"onUpdate:modelValue":s[1]||(s[1]=u=>l.value.assetToken=u),style:{width:"100%"}},{default:e(()=>[(w(!0),z(te,null,ee(_.tokenList,u=>(w(),x(J,{key:u.token,label:u.symbol+(u.token?" - "+u.token:""),value:u.token},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["label"]),t(B,{prop:"amount",label:r(o)("transaction.amount"),style:{width:"100%"},rules:[{required:!0,message:r(o)("transaction.please input amount"),trigger:"blur"}]},{default:e(()=>[t(V,{gutter:20,style:{width:"100%"}},{default:e(()=>[t(a,{span:24},{default:e(()=>[t(I,{modelValue:l.value.amount,"onUpdate:modelValue":s[2]||(s[2]=u=>l.value.amount=u)},null,8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["label","rules"])]),_:1},8,["model"])]),_:1},8,["modelValue","title"])}}}),le=[{constant:!0,inputs:[],name:"name",outputs:[{name:"",type:"string"}],payable:!1,stateMutability:"view",type:"function"},{constant:!1,inputs:[{name:"_spender",type:"address"},{name:"_value",type:"uint256"}],name:"approve",outputs:[{name:"",type:"bool"}],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!0,inputs:[],name:"totalSupply",outputs:[{name:"",type:"uint256"}],payable:!1,stateMutability:"view",type:"function"},{constant:!1,inputs:[{name:"_from",type:"address"},{name:"_to",type:"address"},{name:"_value",type:"uint256"}],name:"transferFrom",outputs:[{name:"",type:"bool"}],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!0,inputs:[],name:"decimals",outputs:[{name:"",type:"uint8"}],payable:!1,stateMutability:"view",type:"function"},{constant:!0,inputs:[{name:"_owner",type:"address"}],name:"balanceOf",outputs:[{name:"balance",type:"uint256"}],payable:!1,stateMutability:"view",type:"function"},{constant:!0,inputs:[],name:"symbol",outputs:[{name:"",type:"string"}],payable:!1,stateMutability:"view",type:"function"},{constant:!1,inputs:[{name:"_to",type:"address"},{name:"_value",type:"uint256"}],name:"transfer",outputs:[{name:"",type:"bool"}],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!0,inputs:[{name:"_owner",type:"address"},{name:"_spender",type:"address"}],name:"allowance",outputs:[{name:"",type:"uint256"}],payable:!1,stateMutability:"view",type:"function"},{payable:!0,stateMutability:"payable",type:"fallback"},{anonymous:!1,inputs:[{indexed:!0,name:"owner",type:"address"},{indexed:!0,name:"spender",type:"address"},{indexed:!1,name:"value",type:"uint256"}],name:"Approval",type:"event"},{anonymous:!1,inputs:[{indexed:!0,name:"from",type:"address"},{indexed:!0,name:"to",type:"address"},{indexed:!1,name:"value",type:"uint256"}],name:"Transfer",type:"event"}],ne={class:"card-header"},se={class:"font-medium"},oe={style:{display:"flex","align-items":"left"}},ie=f("i",{class:"el-icon-time"},null,-1),ue={style:{"margin-left":"10px"}},re={style:{display:"flex","align-items":"left"}},de={style:{"margin-left":"3px"}},ce=L({name:"Assets"}),Me=L({...ce,setup(R){const T=["0xdb5D970F03bfD19c1E51D57BcEd114BC35A0808f"],_=d(!1),m=d(null),c=d([]),g=d(!1),h=d(null);async function k(){m.value=S().getWeb3}const D=async()=>{_.value=!0;const l=await m.value.eth.getBalance(C().getWallet);c.value.push({symbol:"BNB",token:"",balance:N(l,18)}),T.map(async b=>{const p=H(le,b,m.value),A=await p.methods.symbol().call(),v=await p.methods.decimals().call(),n=await p.methods.balanceOf(C().getWallet).call(),s={symbol:A,token:b,balance:N(n,v)};c.value.push(s)}),_.value=!1};j(()=>{k(),D()});const M=l=>{g.value=!0,h.value=l};return(l,b)=>{const p=i("el-table-column"),A=i("el-button"),v=i("el-table"),n=i("el-card"),s=q("loading");return w(),z("div",null,[t(n,{shadow:"never"},{header:e(()=>[f("div",ne,[f("span",se,y(r(o)("assets.assets")),1)])]),default:e(()=>[E((w(),x(v,{data:c.value,style:{width:"100%"}},{default:e(()=>[t(p,{label:r(o)("assets.asset")},{default:e(a=>[f("div",oe,[ie,f("span",ue,y(a.row.symbol),1)])]),_:1},8,["label"]),t(p,{label:r(o)("assets.balance")},{default:e(a=>[f("div",re,[f("span",null,y(a.row.balance),1),f("span",de,y(a.row.symbol),1)])]),_:1},8,["label"]),t(p,{label:r(o)("assets.operation")},{default:e(a=>[t(A,{type:"primary",size:"small",onClick:V=>M(a.row)},{default:e(()=>[W(y(r(o)("wallet.btnSend")),1)]),_:2},1032,["onClick"])]),_:1},8,["label"])]),_:1},8,["data"])),[[s,_.value]])]),_:1}),t(ae,{visible:g.value,"onUpdate:visible":b[0]||(b[0]=a=>g.value=a),data:h.value,tokenList:c.value},null,8,["visible","data","tokenList"])])}}});export{Me as default};

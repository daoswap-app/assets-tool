import{E as u}from"./___vite-browser-external_commonjs-proxy-7f1f402a.js";import{g as q,M,S as X}from"./web3-62625531.js";import{x as L,r as c,w as W,a7 as d,y as x,H as E,I as l,P as e,M as O,O as y,u as i,z as P,a0 as z,F as H,o as Y,A as U,L as $}from"./runtime-core.esm-bundler-c80a0204.js";import{c as G,i as J}from"./addresses-b275d88f.js";import{A as K}from"./arrow-down-s-line-da487a0d.js";import{B as Q}from"./ButtonOfCopy-9be7905e.js";const Z=L({__name:"ChangeThreshold",props:{visible:{type:Boolean,default:!1},data:{type:Object,default:()=>null},connectedWallet:{type:Object,default:null},web3:{type:Object,default:null}},emits:["update:visible","refresh-data"],setup(j,{emit:F}){const a=j,f=c(!1),w=c(!1),_=c(0),V={confirmNumber:1},R=c(),r=c(V),p=async()=>await R.value.validate(g=>!!g),B=async()=>{if(await p()){f.value=!0;const g=q(M,a.data.token,a.web3),v=await g.methods.changeThreshold(r.value.confirmNumber).encodeABI(),t={destination:a.data.token,value:"0",data:v};g.methods.submitTransaction(t.destination,t.value,t.data).send({from:a.connectedWallet.address}).then(()=>{F("refresh-data")}).catch(o=>{console.error(o)}).finally(()=>{f.value=!1,N()})}},N=()=>{w.value=!1};return W(()=>w.value,k=>{F("update:visible",k)}),W(()=>a.visible,k=>{w.value=k}),W(()=>a.data,k=>{f.value=!0,k?(_.value=parseInt(k.ownerCount),r.value.confirmNumber=k.threshold):r.value=V,f.value=!1}),(k,g)=>{const v=d("el-option"),t=d("el-select"),o=d("el-col"),n=d("el-row"),s=d("el-form-item"),b=d("el-form"),I=d("el-button"),S=d("el-dialog");return x(),E(S,{modelValue:w.value,"onUpdate:modelValue":g[1]||(g[1]=C=>w.value=C),title:i(u)("wallet.changeThreshold"),width:"90%",draggable:"","close-on-click-modal":!1,"before-close":N},{footer:l(()=>[e(I,{loading:f.value,onClick:N},{default:l(()=>[O(y(i(u)("wallet.btnCancel")),1)]),_:1},8,["loading"]),e(I,{loading:f.value,type:"primary",onClick:B},{default:l(()=>[O(y(i(u)("wallet.btnSubmit")),1)]),_:1},8,["loading"])]),default:l(()=>[e(b,{ref_key:"walletFormRef",ref:R,model:r.value,"label-width":"100px",class:"demo-ruleForm","hide-required-asterisk":!0,"label-position":"top"},{default:l(()=>[e(s,{prop:"confirmNumber",label:i(u)("wallet.confirmNumber"),style:{width:"100%"},rules:[{required:!0,message:i(u)("wallet.please select confirm number"),trigger:"change"}]},{default:l(()=>[e(n,{gutter:20,style:{width:"100%"}},{default:l(()=>[e(o,{xs:8,md:2},{default:l(()=>[e(t,{modelValue:r.value.confirmNumber,"onUpdate:modelValue":g[0]||(g[0]=C=>r.value.confirmNumber=C)},{default:l(()=>[(x(!0),P(H,null,z(_.value,C=>(x(),E(v,{key:C,label:C,value:C},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),e(o,{xs:1,md:1},{default:l(()=>[O("/")]),_:1}),e(o,{xs:8,md:2},{default:l(()=>[O(y(_.value),1)]),_:1}),e(o,{xs:7,md:19})]),_:1})]),_:1},8,["label","rules"])]),_:1},8,["model"])]),_:1},8,["modelValue","title"])}}}),ee=L({__name:"AddOwner",props:{visible:{type:Boolean,default:!1},data:{type:Object,default:()=>null},connectedWallet:{type:Object,default:null},web3:{type:Object,default:null}},emits:["update:visible","refresh-data"],setup(j,{emit:F}){const a=j,f=c(!1),w=c(!1),_=c([]),V=c(0),R={owner:"",confirmNumber:1},r=c(),p=c(R),B=(v,t,o)=>{t===""?o(new Error(u("wallet.please input wallet address"))):(p.value.owner=G(p.value.owner),J(p.value.owner)?_.value.filter(s=>s.toLowerCase()===t.toLowerCase()).length>0?o(new Error(u("wallet.owner is already added"))):o():o(new Error(u("wallet.invalid wallet address"))))},N=async()=>await r.value.validate(t=>!!t),k=async()=>{if(await N()){f.value=!0;const t=q(M,a.data.token,a.web3),o=await t.methods.addOwnerWithThreshold(p.value.owner,p.value.confirmNumber).encodeABI(),n={destination:a.data.token,value:"0",data:o};t.methods.submitTransaction(n.destination,n.value,n.data).send({from:a.connectedWallet.address}).then(()=>{F("refresh-data")}).catch(s=>{console.error(s)}).finally(()=>{f.value=!1,g()})}},g=()=>{w.value=!1};return W(()=>w.value,v=>{F("update:visible",v)}),W(()=>a.visible,v=>{w.value=v}),W(()=>a.data,v=>{f.value=!0,v?(_.value=v.owners,V.value=parseInt(v.ownerCount)+1,p.value.confirmNumber=v.threshold):p.value=R,f.value=!1}),(v,t)=>{const o=d("el-input"),n=d("el-col"),s=d("el-row"),b=d("el-form-item"),I=d("el-divider"),S=d("el-option"),C=d("el-select"),T=d("el-form"),A=d("el-button"),m=d("el-dialog");return x(),E(m,{modelValue:w.value,"onUpdate:modelValue":t[2]||(t[2]=h=>w.value=h),title:i(u)("wallet.addOwner"),width:"90%",draggable:"","close-on-click-modal":!1,"before-close":g},{footer:l(()=>[e(A,{loading:f.value,onClick:g},{default:l(()=>[O(y(i(u)("wallet.btnCancel")),1)]),_:1},8,["loading"]),e(A,{loading:f.value,type:"primary",onClick:k},{default:l(()=>[O(y(i(u)("wallet.btnSubmit")),1)]),_:1},8,["loading"])]),default:l(()=>[e(T,{ref_key:"walletFormRef",ref:r,model:p.value,"label-width":"100px",class:"demo-ruleForm","hide-required-asterisk":!0,"label-position":"top"},{default:l(()=>[e(b,{prop:"owner",label:i(u)("wallet.owners"),style:{width:"100%"},rules:[{validator:B,trigger:"blur"}]},{default:l(()=>[e(s,{gutter:20,style:{width:"100%"}},{default:l(()=>[e(n,{span:24},{default:l(()=>[e(o,{modelValue:p.value.owner,"onUpdate:modelValue":t[0]||(t[0]=h=>p.value.owner=h)},null,8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["label","rules"]),e(I),e(b,{prop:"confirmNumber",label:i(u)("wallet.confirmNumber"),style:{width:"100%"},rules:[{required:!0,message:i(u)("wallet.please select confirm number"),trigger:"change"}]},{default:l(()=>[e(s,{gutter:20,style:{width:"100%"}},{default:l(()=>[e(n,{xs:8,md:2},{default:l(()=>[e(C,{modelValue:p.value.confirmNumber,"onUpdate:modelValue":t[1]||(t[1]=h=>p.value.confirmNumber=h)},{default:l(()=>[(x(!0),P(H,null,z(V.value,h=>(x(),E(S,{key:h,label:h,value:h},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),e(n,{xs:1,md:1},{default:l(()=>[O("/")]),_:1}),e(n,{xs:8,md:2},{default:l(()=>[O(y(V.value),1)]),_:1}),e(n,{xs:7,md:19})]),_:1})]),_:1},8,["label","rules"])]),_:1},8,["model"])]),_:1},8,["modelValue","title"])}}}),le=L({__name:"SwapOwner",props:{visible:{type:Boolean,default:!1},data:{type:Object,default:()=>null},connectedWallet:{type:Object,default:null},web3:{type:Object,default:null},owner:{type:String,default:""}},emits:["update:visible","refresh-data"],setup(j,{emit:F}){const a=j,f=c(!1),w=c(!1),_=c([]),V={owner:"",newOwner:""},R=c(),r=c(V),p=c(""),B=(t,o,n)=>{o===""?n(new Error(u("wallet.please input wallet address"))):(r.value.newOwner=G(r.value.newOwner),J(r.value.newOwner)?_.value.filter(b=>b.toLowerCase()===o.toLowerCase()).length>0?n(new Error(u("wallet.owner is already added"))):n():n(new Error(u("wallet.invalid wallet address"))))},N=async()=>await R.value.validate(o=>!!o),k=async()=>{if(await N()){f.value=!0;const o=q(M,a.data.token,a.web3),n=await o.methods.swapOwner(p.value,r.value.owner,r.value.newOwner).encodeABI(),s={destination:a.data.token,value:"0",data:n};o.methods.submitTransaction(s.destination,s.value,s.data).send({from:a.connectedWallet.address}).then(()=>{F("refresh-data")}).catch(b=>{console.error(b)}).finally(()=>{f.value=!1,v()})}},g=async()=>{const t=a.data.owners,o=t.findIndex(s=>s===r.value.owner),n=parseInt(o)-1;n>=0?p.value=t[n]:p.value=X},v=()=>{w.value=!1};return W(()=>w.value,t=>{F("update:visible",t)}),W(()=>a.visible,t=>{w.value=t}),W(()=>a.data,t=>{f.value=!0,t?(_.value=t.owners,r.value.owner=a.owner):r.value=V,g(),f.value=!1}),W(()=>a.owner,t=>{r.value.owner=t,g()}),(t,o)=>{const n=d("el-input"),s=d("el-col"),b=d("el-row"),I=d("el-form-item"),S=d("el-form"),C=d("el-button"),T=d("el-dialog");return x(),E(T,{modelValue:w.value,"onUpdate:modelValue":o[2]||(o[2]=A=>w.value=A),title:i(u)("wallet.swapOwner"),width:"90%",draggable:"","close-on-click-modal":!1,"before-close":v},{footer:l(()=>[e(C,{loading:f.value,onClick:v},{default:l(()=>[O(y(i(u)("wallet.btnCancel")),1)]),_:1},8,["loading"]),e(C,{loading:f.value,type:"primary",onClick:k},{default:l(()=>[O(y(i(u)("wallet.btnSubmit")),1)]),_:1},8,["loading"])]),default:l(()=>[e(S,{ref_key:"walletFormRef",ref:R,model:r.value,"label-width":"100px",class:"demo-ruleForm","hide-required-asterisk":!0,"label-position":"top"},{default:l(()=>[e(I,{prop:"owner",label:i(u)("wallet.oldOwner"),style:{width:"100%"},rules:[{required:!0,message:i(u)("wallet.please input wallet address"),trigger:"blur"}]},{default:l(()=>[e(b,{gutter:20,style:{width:"100%"}},{default:l(()=>[e(s,{span:24},{default:l(()=>[e(n,{modelValue:r.value.owner,"onUpdate:modelValue":o[0]||(o[0]=A=>r.value.owner=A),disabled:!0},null,8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["label","rules"]),e(I,{prop:"newOwner",label:i(u)("wallet.newOwner"),style:{width:"100%"},rules:[{validator:B,trigger:"blur"}]},{default:l(()=>[e(b,{gutter:20,style:{width:"100%"}},{default:l(()=>[e(s,{span:24},{default:l(()=>[e(n,{modelValue:r.value.newOwner,"onUpdate:modelValue":o[1]||(o[1]=A=>r.value.newOwner=A)},null,8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["label","rules"])]),_:1},8,["model"])]),_:1},8,["modelValue","title"])}}}),te=L({__name:"RemoveOwner",props:{visible:{type:Boolean,default:!1},data:{type:Object,default:()=>null},connectedWallet:{type:Object,default:null},web3:{type:Object,default:null},owner:{type:String,default:""}},emits:["update:visible","refresh-data"],setup(j,{emit:F}){const a=j,f=c(!1),w=c(!1),_=c(0),V={owner:"",confirmNumber:1},R=c(),r=c(V),p=c(""),B=(t,o,n)=>{o===""?n(new Error(u("wallet.please input wallet address"))):(r.value.owner=G(r.value.owner),J(r.value.owner)?n():n(new Error(u("wallet.invalid wallet address"))))},N=async()=>await R.value.validate(o=>!!o),k=async()=>{if(await N()){f.value=!0;const o=q(M,a.data.token,a.web3),n=await o.methods.removeOwner(p.value,r.value.owner,r.value.confirmNumber).encodeABI(),s={destination:a.data.token,value:"0",data:n};o.methods.submitTransaction(s.destination,s.value,s.data).send({from:a.connectedWallet.address}).then(()=>{F("refresh-data")}).catch(b=>{console.error(b)}).finally(()=>{f.value=!1,v()})}},g=async()=>{const t=a.data.owners,o=t.findIndex(s=>s===r.value.owner),n=parseInt(o)-1;n>=0?p.value=t[n]:p.value=X},v=()=>{w.value=!1};return W(()=>w.value,t=>{F("update:visible",t)}),W(()=>a.visible,t=>{w.value=t}),W(()=>a.data,t=>{f.value=!0,t?(r.value.owner=a.owner,_.value=parseInt(t.ownerCount)-1,r.value.confirmNumber=parseInt(t.threshold)<=_.value?parseInt(t.threshold):_.value):r.value=V,g(),f.value=!1}),W(()=>a.owner,t=>{r.value.owner=t,g()}),(t,o)=>{const n=d("el-input"),s=d("el-col"),b=d("el-row"),I=d("el-form-item"),S=d("el-divider"),C=d("el-option"),T=d("el-select"),A=d("el-form"),m=d("el-button"),h=d("el-dialog");return x(),E(h,{modelValue:w.value,"onUpdate:modelValue":o[2]||(o[2]=D=>w.value=D),title:i(u)("wallet.removeOwner"),width:"90%",draggable:"","close-on-click-modal":!1,"before-close":v},{footer:l(()=>[e(m,{loading:f.value,onClick:v},{default:l(()=>[O(y(i(u)("wallet.btnCancel")),1)]),_:1},8,["loading"]),e(m,{loading:f.value,type:"primary",onClick:k},{default:l(()=>[O(y(i(u)("wallet.btnSubmit")),1)]),_:1},8,["loading"])]),default:l(()=>[e(A,{ref_key:"walletFormRef",ref:R,model:r.value,"label-width":"100px",class:"demo-ruleForm","hide-required-asterisk":!0,"label-position":"top"},{default:l(()=>[e(I,{prop:"owner",label:i(u)("wallet.owners"),style:{width:"100%"},rules:[{validator:B,trigger:"blur"}]},{default:l(()=>[e(b,{gutter:20,style:{width:"100%"}},{default:l(()=>[e(s,{span:24},{default:l(()=>[e(n,{modelValue:r.value.owner,"onUpdate:modelValue":o[0]||(o[0]=D=>r.value.owner=D),disabled:!0},null,8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["label","rules"]),e(S),e(I,{prop:"confirmNumber",label:i(u)("wallet.confirmNumber"),style:{width:"100%"},rules:[{required:!0,message:i(u)("wallet.please select confirm number"),trigger:"change"}]},{default:l(()=>[e(b,{gutter:20,style:{width:"100%"}},{default:l(()=>[e(s,{xs:8,md:2},{default:l(()=>[e(T,{modelValue:r.value.confirmNumber,"onUpdate:modelValue":o[1]||(o[1]=D=>r.value.confirmNumber=D)},{default:l(()=>[(x(!0),P(H,null,z(_.value,D=>(x(),E(C,{key:D,label:D,value:D},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),e(s,{xs:1,md:1},{default:l(()=>[O("/")]),_:1}),e(s,{xs:8,md:2},{default:l(()=>[O(y(_.value),1)]),_:1}),e(s,{xs:7,md:19})]),_:1})]),_:1},8,["label","rules"])]),_:1},8,["model"])]),_:1},8,["modelValue","title"])}}}),ae={style:{display:"flex","align-items":"left"}},oe={style:{display:"flex","align-items":"left"}},ne={style:{display:"flex","align-items":"left"}},re={style:{display:"flex","align-items":"left"}},se=L({name:"WalletTable"}),we=L({...se,props:{data:{type:Object,default:()=>[]},connectedWallet:{type:Object,default:null},web3:{type:Object,default:null},currentWallet:{type:String,default:""}},emits:["refresh-wallet-list","change-wallet"],setup(j,{emit:F}){const a=j,f=c(!1),w=c([]),_=c(null),V=c(""),R=c(!1),r=c(!1),p=c(!1),B=c(!1),N=()=>{F("refresh-wallet-list")},k=n=>{F("change-wallet",n)},g=n=>{_.value=n,R.value=!0},v=n=>{_.value=n,r.value=!0},t=(n,s)=>{_.value=n,V.value=s,p.value=!0},o=(n,s)=>{_.value=n,V.value=s,B.value=!0};return W(()=>a.data,n=>{f.value=!0,w.value=n,f.value=!1}),Y(()=>{a.data&&a.connectedWallet&&a.web3&&a.currentWallet&&(w.value=a.data)}),(n,s)=>{const b=d("el-table-column"),I=d("IconifyIconOffline"),S=d("el-dropdown-item"),C=d("el-dropdown-menu"),T=d("el-dropdown"),A=d("el-table");return x(),P("div",null,[e(A,{data:w.value,style:{width:"100%"}},{default:l(()=>[e(b,{type:"expand"},{default:l(m=>[e(A,{data:m.row.owners,stripe:"",style:{width:"100%"}},{default:l(()=>[e(b,{label:i(u)("wallet.ownerAddress")},{default:l(h=>[U("div",ae,[U("span",null,[e(Q,{text:h.row},null,8,["text"])])])]),_:1},8,["label"]),e(b,{label:i(u)("wallet.operation")},{default:l(h=>[e(T,{trigger:"click"},{dropdown:l(()=>[e(C,null,{default:l(()=>[e(S,{onClick:D=>t(m.row,h.row)},{default:l(()=>[O(y(i(u)("wallet.btnSwapOwner")),1)]),_:2},1032,["onClick"]),m.row.owners.length>1?(x(),E(S,{key:0,onClick:D=>o(m.row,h.row),divided:""},{default:l(()=>[O(y(i(u)("wallet.btnDelete")),1)]),_:2},1032,["onClick"])):$("",!0)]),_:2},1024)]),default:l(()=>[e(I,{icon:i(K),class:"text-[24px]"},null,8,["icon"])]),_:2},1024)]),_:2},1032,["label"])]),_:2},1032,["data"])]),_:1}),e(b,{label:i(u)("wallet.address")},{default:l(m=>[U("div",oe,[U("span",null,[e(Q,{text:m.row.token},null,8,["text"])])])]),_:1},8,["label"]),e(b,{label:i(u)("wallet.name")},{default:l(m=>[U("div",ne,[U("span",null,y(m.row.name),1)])]),_:1},8,["label"]),e(b,{label:i(u)("wallet.numberOfSigner")},{default:l(m=>[U("div",re,[U("span",null,y(m.row.threshold)+" / "+y(m.row.ownerCount),1)])]),_:1},8,["label"]),e(b,{label:i(u)("wallet.operation")},{default:l(m=>[e(T,{trigger:"click"},{dropdown:l(()=>[e(C,null,{default:l(()=>[e(S,{disabled:m.row.token.toLowerCase()===a.currentWallet.toLowerCase(),onClick:h=>k(m.row)},{default:l(()=>[O(y(m.row.token.toLowerCase()===a.currentWallet.toLowerCase()?i(u)("wallet.btnSelectedWallet"):i(u)("wallet.btnChangeWallet")),1)]),_:2},1032,["disabled","onClick"]),e(S,{onClick:h=>v(m.row),divided:""},{default:l(()=>[O(y(i(u)("wallet.btnAddOwner")),1)]),_:2},1032,["onClick"]),e(S,{onClick:h=>g(m.row)},{default:l(()=>[O(y(i(u)("wallet.btnChangeThreshold")),1)]),_:2},1032,["onClick"])]),_:2},1024)]),default:l(()=>[e(I,{icon:i(K),class:"text-[24px]"},null,8,["icon"])]),_:2},1024)]),_:1},8,["label"])]),_:1},8,["data"]),a.web3?(x(),E(ee,{key:0,visible:r.value,"onUpdate:visible":s[0]||(s[0]=m=>r.value=m),data:_.value,connectedWallet:a.connectedWallet,web3:a.web3,onRefreshData:N},null,8,["visible","data","connectedWallet","web3"])):$("",!0),a.web3?(x(),E(Z,{key:1,visible:R.value,"onUpdate:visible":s[1]||(s[1]=m=>R.value=m),data:_.value,connectedWallet:a.connectedWallet,web3:a.web3,onRefreshData:N},null,8,["visible","data","connectedWallet","web3"])):$("",!0),a.web3?(x(),E(le,{key:2,visible:p.value,"onUpdate:visible":s[2]||(s[2]=m=>p.value=m),data:_.value,connectedWallet:a.connectedWallet,web3:a.web3,owner:V.value,onRefreshData:N},null,8,["visible","data","connectedWallet","web3","owner"])):$("",!0),a.web3?(x(),E(te,{key:3,visible:B.value,"onUpdate:visible":s[3]||(s[3]=m=>B.value=m),data:_.value,connectedWallet:a.connectedWallet,web3:a.web3,owner:V.value,onRefreshData:N},null,8,["visible","data","connectedWallet","web3","owner"])):$("",!0)])}}});export{we as _};

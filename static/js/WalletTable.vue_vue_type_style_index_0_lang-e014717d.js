import{t as s}from"./i18n-4a0f4af2.js";import{M as q}from"./MultiSigWallet_abi-6912cb8d.js";import{g as z}from"./web3-dfdb1234.js";import{x as T,r as f,w as W,a7 as d,y as k,H as S,I as e,P as l,M as y,O as b,u as i,z as M,a0 as P,F as H,o as Q,A as L,L as B}from"./runtime-core.esm-bundler-c80a0204.js";import{c as G,i as J}from"./addresses-acfad7e8.js";import{S as K}from"./constants-b9202782.js";const X=T({__name:"ChangeThreshold",props:{visible:{type:Boolean,default:!1},data:{type:Object,default:()=>null},connectedWallet:{type:Object,default:null},web3:{type:Object,default:null}},emits:["update:visible","refresh-data"],setup(A,{emit:F}){const t=A,w=f(!1),m=f(!1),_=f(0),V={confirmNumber:1},R=f(),o=f(V),p=async()=>await R.value.validate(h=>!!h),D=async()=>{await p()&&(w.value=!0,z(q,t.data.token,t.web3).methods.changeThreshold(o.value.confirmNumber).send({from:t.connectedWallet.address}).then(()=>{F("refresh-data")}).catch(v=>{console.error(v)}).finally(()=>{w.value=!1,N()}))},N=()=>{m.value=!1};return W(()=>m.value,O=>{F("update:visible",O)}),W(()=>t.visible,O=>{m.value=O}),W(()=>t.data,O=>{w.value=!0,O?(_.value=parseInt(O.ownerCount),o.value.confirmNumber=O.threshold):o.value=V,w.value=!1}),(O,h)=>{const v=d("el-option"),a=d("el-select"),r=d("el-col"),n=d("el-row"),c=d("el-form-item"),g=d("el-form"),C=d("el-button"),I=d("el-dialog");return k(),S(I,{modelValue:m.value,"onUpdate:modelValue":h[1]||(h[1]=u=>m.value=u),title:i(s)("wallet.changeThreshold"),width:"90%",draggable:"","close-on-click-modal":!1,"before-close":N},{footer:e(()=>[l(C,{loading:w.value,onClick:N},{default:e(()=>[y(b(i(s)("wallet.btnCancel")),1)]),_:1},8,["loading"]),l(C,{loading:w.value,type:"primary",onClick:D},{default:e(()=>[y(b(i(s)("wallet.btnSubmit")),1)]),_:1},8,["loading"])]),default:e(()=>[l(g,{ref_key:"walletFormRef",ref:R,model:o.value,"label-width":"100px",class:"demo-ruleForm","hide-required-asterisk":!0},{default:e(()=>[l(c,{prop:"confirmNumber",label:i(s)("wallet.confirmNumber"),style:{width:"100%"},rules:[{required:!0,message:i(s)("wallet.please select confirm number"),trigger:"change"}]},{default:e(()=>[l(n,{gutter:20,style:{width:"100%"}},{default:e(()=>[l(r,{span:2},{default:e(()=>[l(a,{modelValue:o.value.confirmNumber,"onUpdate:modelValue":h[0]||(h[0]=u=>o.value.confirmNumber=u)},{default:e(()=>[(k(!0),M(H,null,P(_.value,u=>(k(),S(v,{key:u,label:u,value:u},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),l(r,{span:1},{default:e(()=>[y("/")]),_:1}),l(r,{span:2},{default:e(()=>[y(b(_.value),1)]),_:1}),l(r,{span:19})]),_:1})]),_:1},8,["label","rules"])]),_:1},8,["model"])]),_:1},8,["modelValue","title"])}}}),Y=T({__name:"AddOwner",props:{visible:{type:Boolean,default:!1},data:{type:Object,default:()=>null},connectedWallet:{type:Object,default:null},web3:{type:Object,default:null}},emits:["update:visible","refresh-data"],setup(A,{emit:F}){const t=A,w=f(!1),m=f(!1),_=f([]),V=f(0),R={owner:"",confirmNumber:1},o=f(),p=f(R),D=(v,a,r)=>{a===""?r(new Error(s("wallet.please input wallet address"))):(p.value.owner=G(p.value.owner),J(p.value.owner)?_.value.filter(c=>c.toLowerCase()===a.toLowerCase()).length>0?r(new Error(s("wallet.owner is already added"))):r():r(new Error(s("wallet.invalid wallet address"))))},N=async()=>await o.value.validate(a=>!!a),O=async()=>{await N()&&(w.value=!0,z(q,t.data.token,t.web3).methods.addOwnerWithThreshold(p.value.owner,p.value.confirmNumber).send({from:t.connectedWallet.address}).then(()=>{F("refresh-data")}).catch(r=>{console.error(r)}).finally(()=>{w.value=!1,h()}))},h=()=>{m.value=!1};return W(()=>m.value,v=>{F("update:visible",v)}),W(()=>t.visible,v=>{m.value=v}),W(()=>t.data,v=>{w.value=!0,v?(_.value=v.owners,V.value=parseInt(v.ownerCount)+1,p.value.confirmNumber=v.threshold):p.value=R,w.value=!1}),(v,a)=>{const r=d("el-input"),n=d("el-col"),c=d("el-row"),g=d("el-form-item"),C=d("el-divider"),I=d("el-option"),u=d("el-select"),x=d("el-form"),j=d("el-button"),$=d("el-dialog");return k(),S($,{modelValue:m.value,"onUpdate:modelValue":a[2]||(a[2]=U=>m.value=U),title:i(s)("wallet.addOwner"),width:"90%",draggable:"","close-on-click-modal":!1,"before-close":h},{footer:e(()=>[l(j,{loading:w.value,onClick:h},{default:e(()=>[y(b(i(s)("wallet.btnCancel")),1)]),_:1},8,["loading"]),l(j,{loading:w.value,type:"primary",onClick:O},{default:e(()=>[y(b(i(s)("wallet.btnSubmit")),1)]),_:1},8,["loading"])]),default:e(()=>[l(x,{ref_key:"walletFormRef",ref:o,model:p.value,"label-width":"100px",class:"demo-ruleForm","hide-required-asterisk":!0},{default:e(()=>[l(g,{prop:"owner",label:i(s)("wallet.owners"),style:{width:"100%"},rules:[{validator:D,trigger:"blur"}]},{default:e(()=>[l(c,{gutter:20,style:{width:"100%"}},{default:e(()=>[l(n,{span:24},{default:e(()=>[l(r,{modelValue:p.value.owner,"onUpdate:modelValue":a[0]||(a[0]=U=>p.value.owner=U)},null,8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["label","rules"]),l(C),l(g,{prop:"confirmNumber",label:i(s)("wallet.confirmNumber"),style:{width:"100%"},rules:[{required:!0,message:i(s)("wallet.please select confirm number"),trigger:"change"}]},{default:e(()=>[l(c,{gutter:20,style:{width:"100%"}},{default:e(()=>[l(n,{span:2},{default:e(()=>[l(u,{modelValue:p.value.confirmNumber,"onUpdate:modelValue":a[1]||(a[1]=U=>p.value.confirmNumber=U)},{default:e(()=>[(k(!0),M(H,null,P(V.value,U=>(k(),S(I,{key:U,label:U,value:U},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),l(n,{span:1},{default:e(()=>[y("/")]),_:1}),l(n,{span:2},{default:e(()=>[y(b(V.value),1)]),_:1}),l(n,{span:19})]),_:1})]),_:1},8,["label","rules"])]),_:1},8,["model"])]),_:1},8,["modelValue","title"])}}}),Z=T({__name:"SwapOwner",props:{visible:{type:Boolean,default:!1},data:{type:Object,default:()=>null},connectedWallet:{type:Object,default:null},web3:{type:Object,default:null},owner:{type:String,default:""}},emits:["update:visible","refresh-data"],setup(A,{emit:F}){const t=A,w=f(!1),m=f(!1),_=f([]),V={owner:"",newOwner:""},R=f(),o=f(V),p=f(""),D=(a,r,n)=>{r===""?n(new Error(s("wallet.please input wallet address"))):(o.value.newOwner=G(o.value.newOwner),J(o.value.newOwner)?_.value.filter(g=>g.toLowerCase()===r.toLowerCase()).length>0?n(new Error(s("wallet.owner is already added"))):n():n(new Error(s("wallet.invalid wallet address"))))},N=async()=>await R.value.validate(r=>!!r),O=async()=>{await N()&&(w.value=!0,z(q,t.data.token,t.web3).methods.swapOwner(p.value,o.value.owner,o.value.newOwner).send({from:t.connectedWallet.address}).then(()=>{F("refresh-data")}).catch(n=>{console.error(n)}).finally(()=>{w.value=!1,v()}))},h=async()=>{const a=t.data.owners,r=a.findIndex(c=>c===o.value.owner),n=parseInt(r)-1;n>=0?p.value=a[n]:p.value=K},v=()=>{m.value=!1};return W(()=>m.value,a=>{F("update:visible",a)}),W(()=>t.visible,a=>{m.value=a}),W(()=>t.data,a=>{w.value=!0,a?(_.value=a.owners,o.value.owner=t.owner):o.value=V,h(),w.value=!1}),W(()=>t.owner,a=>{o.value.owner=a,h()}),(a,r)=>{const n=d("el-input"),c=d("el-col"),g=d("el-row"),C=d("el-form-item"),I=d("el-form"),u=d("el-button"),x=d("el-dialog");return k(),S(x,{modelValue:m.value,"onUpdate:modelValue":r[2]||(r[2]=j=>m.value=j),title:i(s)("wallet.swapOwner"),width:"90%",draggable:"","close-on-click-modal":!1,"before-close":v},{footer:e(()=>[l(u,{loading:w.value,onClick:v},{default:e(()=>[y(b(i(s)("wallet.btnCancel")),1)]),_:1},8,["loading"]),l(u,{loading:w.value,type:"primary",onClick:O},{default:e(()=>[y(b(i(s)("wallet.btnSubmit")),1)]),_:1},8,["loading"])]),default:e(()=>[l(I,{ref_key:"walletFormRef",ref:R,model:o.value,"label-width":"100px",class:"demo-ruleForm","hide-required-asterisk":!0},{default:e(()=>[l(C,{prop:"owner",label:i(s)("wallet.oldOwner"),style:{width:"100%"},rules:[{required:!0,message:i(s)("wallet.please input wallet address"),trigger:"blur"}]},{default:e(()=>[l(g,{gutter:20,style:{width:"100%"}},{default:e(()=>[l(c,{span:24},{default:e(()=>[l(n,{modelValue:o.value.owner,"onUpdate:modelValue":r[0]||(r[0]=j=>o.value.owner=j),disabled:!0},null,8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["label","rules"]),l(C,{prop:"newOwner",label:i(s)("wallet.newOwner"),style:{width:"100%"},rules:[{validator:D,trigger:"blur"}]},{default:e(()=>[l(g,{gutter:20,style:{width:"100%"}},{default:e(()=>[l(c,{span:24},{default:e(()=>[l(n,{modelValue:o.value.newOwner,"onUpdate:modelValue":r[1]||(r[1]=j=>o.value.newOwner=j)},null,8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["label","rules"])]),_:1},8,["model"])]),_:1},8,["modelValue","title"])}}}),ee=T({__name:"RemoveOwner",props:{visible:{type:Boolean,default:!1},data:{type:Object,default:()=>null},connectedWallet:{type:Object,default:null},web3:{type:Object,default:null},owner:{type:String,default:""}},emits:["update:visible","refresh-data"],setup(A,{emit:F}){const t=A,w=f(!1),m=f(!1),_=f(0),V={owner:"",confirmNumber:1},R=f(),o=f(V),p=f(""),D=(a,r,n)=>{r===""?n(new Error(s("wallet.please input wallet address"))):(o.value.owner=G(o.value.owner),J(o.value.owner)?n():n(new Error(s("wallet.invalid wallet address"))))},N=async()=>await R.value.validate(r=>!!r),O=async()=>{await N()&&(w.value=!0,z(q,t.data.token,t.web3).methods.removeOwner(p.value,o.value.owner,o.value.confirmNumber).send({from:t.connectedWallet.address}).then(()=>{F("refresh-data")}).catch(n=>{console.error(n)}).finally(()=>{w.value=!1,v()}))},h=async()=>{const a=t.data.owners,r=a.findIndex(c=>c===o.value.owner),n=parseInt(r)-1;n>=0?p.value=a[n]:p.value=K},v=()=>{m.value=!1};return W(()=>m.value,a=>{F("update:visible",a)}),W(()=>t.visible,a=>{m.value=a}),W(()=>t.data,a=>{w.value=!0,a?(o.value.owner=t.owner,_.value=parseInt(a.ownerCount)-1,o.value.confirmNumber=a.threshold):o.value=V,h(),w.value=!1}),W(()=>t.owner,a=>{o.value.owner=a,h()}),(a,r)=>{const n=d("el-input"),c=d("el-col"),g=d("el-row"),C=d("el-form-item"),I=d("el-divider"),u=d("el-option"),x=d("el-select"),j=d("el-form"),$=d("el-button"),U=d("el-dialog");return k(),S(U,{modelValue:m.value,"onUpdate:modelValue":r[2]||(r[2]=E=>m.value=E),title:i(s)("wallet.removeOwner"),width:"90%",draggable:"","close-on-click-modal":!1,"before-close":v},{footer:e(()=>[l($,{loading:w.value,onClick:v},{default:e(()=>[y(b(i(s)("wallet.btnCancel")),1)]),_:1},8,["loading"]),l($,{loading:w.value,type:"primary",onClick:O},{default:e(()=>[y(b(i(s)("wallet.btnSubmit")),1)]),_:1},8,["loading"])]),default:e(()=>[l(j,{ref_key:"walletFormRef",ref:R,model:o.value,"label-width":"100px",class:"demo-ruleForm","hide-required-asterisk":!0},{default:e(()=>[l(C,{prop:"owner",label:i(s)("wallet.owners"),style:{width:"100%"},rules:[{validator:D,trigger:"blur"}]},{default:e(()=>[l(g,{gutter:20,style:{width:"100%"}},{default:e(()=>[l(c,{span:24},{default:e(()=>[l(n,{modelValue:o.value.owner,"onUpdate:modelValue":r[0]||(r[0]=E=>o.value.owner=E),disabled:!0},null,8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["label","rules"]),l(I),l(C,{prop:"confirmNumber",label:i(s)("wallet.confirmNumber"),style:{width:"100%"},rules:[{required:!0,message:i(s)("wallet.please select confirm number"),trigger:"change"}]},{default:e(()=>[l(g,{gutter:20,style:{width:"100%"}},{default:e(()=>[l(c,{span:2},{default:e(()=>[l(x,{modelValue:o.value.confirmNumber,"onUpdate:modelValue":r[1]||(r[1]=E=>o.value.confirmNumber=E)},{default:e(()=>[(k(!0),M(H,null,P(_.value,E=>(k(),S(u,{key:E,label:E,value:E},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),l(c,{span:1},{default:e(()=>[y("/")]),_:1}),l(c,{span:2},{default:e(()=>[y(b(_.value),1)]),_:1}),l(c,{span:19})]),_:1})]),_:1},8,["label","rules"])]),_:1},8,["model"])]),_:1},8,["modelValue","title"])}}}),le={style:{display:"flex","align-items":"left"}},te={style:{display:"flex","align-items":"left"}},ae={style:{display:"flex","align-items":"left"}},ne={style:{display:"flex","align-items":"left"}},oe=T({name:"WalletTable"}),fe=T({...oe,props:{data:{type:Object,default:()=>[]},connectedWallet:{type:Object,default:null},web3:{type:Object,default:null},currentWallet:{type:String,default:""}},emits:["refresh-wallet-list","change-wallet","change-threshold","add-owner","swap-owner","remove-owner"],setup(A,{emit:F}){const t=A,w=f(!1),m=f([]),_=f(null),V=f(""),R=f(!1),o=f(!1),p=f(!1),D=f(!1),N=()=>{F("refresh-wallet-list")},O=n=>{F("change-wallet",n)},h=n=>{_.value=n,R.value=!0},v=n=>{_.value=n,o.value=!0},a=(n,c)=>{_.value=n,V.value=c,p.value=!0},r=(n,c)=>{_.value=n,V.value=c,D.value=!0};return W(()=>t.data,n=>{w.value=!0,m.value=n,w.value=!1}),Q(()=>{t.data&&t.connectedWallet&&t.web3&&t.currentWallet&&(m.value=t.data)}),(n,c)=>{const g=d("el-table-column"),C=d("el-button"),I=d("el-table");return k(),M("div",null,[l(I,{data:m.value,style:{width:"100%"}},{default:e(()=>[l(g,{type:"expand"},{default:e(u=>[l(I,{data:u.row.owners,style:{width:"100%"}},{default:e(()=>[l(g,{label:i(s)("wallet.address")},{default:e(x=>[L("div",le,[L("span",null,b(x.row),1)])]),_:1},8,["label"]),l(g,{label:i(s)("wallet.operation")},{default:e(x=>[l(C,{type:"primary",size:"small",onClick:j=>a(u.row,x.row)},{default:e(()=>[y(b(i(s)("wallet.btnSwapOwner")),1)]),_:2},1032,["onClick"]),u.row.owners.length>1?(k(),S(C,{key:0,type:"danger",size:"small",onClick:j=>r(u.row,x.row)},{default:e(()=>[y(b(i(s)("wallet.btnDelete")),1)]),_:2},1032,["onClick"])):B("",!0)]),_:2},1032,["label"])]),_:2},1032,["data"])]),_:1}),l(g,{label:i(s)("wallet.address")},{default:e(u=>[L("div",te,[L("span",null,b(u.row.token),1)])]),_:1},8,["label"]),l(g,{label:i(s)("wallet.name")},{default:e(u=>[L("div",ae,[L("span",null,b(u.row.name),1)])]),_:1},8,["label"]),l(g,{label:i(s)("wallet.confirmNumber")+"/"+i(s)("wallet.ownerCount")},{default:e(u=>[L("div",ne,[L("span",null,b(u.row.threshold)+" / "+b(u.row.ownerCount),1)])]),_:1},8,["label"]),l(g,{label:i(s)("wallet.operation"),fixed:"right",width:"400"},{default:e(u=>[l(C,{size:"small",type:"primary",disabled:u.row.token.toLowerCase()===t.currentWallet.toLowerCase(),onClick:x=>O(u.row)},{default:e(()=>[y(b(u.row.token.toLowerCase()===t.currentWallet.toLowerCase()?i(s)("wallet.btnSelectedWallet"):i(s)("wallet.btnChangeWallet")),1)]),_:2},1032,["disabled","onClick"]),u.row.confirmStatus?B("",!0):(k(),S(C,{key:0,type:"primary",size:"small",onClick:x=>v(u.row)},{default:e(()=>[y(b(i(s)("wallet.btnAddOwner")),1)]),_:2},1032,["onClick"])),l(C,{type:"primary",size:"small",onClick:x=>h(u.row)},{default:e(()=>[y(b(i(s)("wallet.btnChangeThreshold")),1)]),_:2},1032,["onClick"])]),_:1},8,["label"])]),_:1},8,["data"]),t.web3?(k(),S(Y,{key:0,visible:o.value,"onUpdate:visible":c[0]||(c[0]=u=>o.value=u),data:_.value,connectedWallet:t.connectedWallet,web3:t.web3,onRefreshData:N},null,8,["visible","data","connectedWallet","web3"])):B("",!0),t.web3?(k(),S(X,{key:1,visible:R.value,"onUpdate:visible":c[1]||(c[1]=u=>R.value=u),data:_.value,connectedWallet:t.connectedWallet,web3:t.web3,onRefreshData:N},null,8,["visible","data","connectedWallet","web3"])):B("",!0),t.web3?(k(),S(Z,{key:2,visible:p.value,"onUpdate:visible":c[2]||(c[2]=u=>p.value=u),data:_.value,connectedWallet:t.connectedWallet,web3:t.web3,owner:V.value,onRefreshData:N},null,8,["visible","data","connectedWallet","web3","owner"])):B("",!0),t.web3?(k(),S(ee,{key:3,visible:D.value,"onUpdate:visible":c[3]||(c[3]=u=>D.value=u),data:_.value,connectedWallet:t.connectedWallet,web3:t.web3,owner:V.value,onRefreshData:N},null,8,["visible","data","connectedWallet","web3","owner"])):B("",!0)])}}});export{fe as _};

import{E as r}from"./___vite-browser-external_commonjs-proxy-7f1f402a.js";import{A as j}from"./arrow-down-s-line-da487a0d.js";import{g as T,M as W,a as O}from"./web3-bdfc4e9c.js";import{g as z,d as J,a as q,c as G}from"./getLogs-a8100a6a.js";import{B as K}from"./ButtonOfCopy-7cfa85d9.js";import{i as U}from"./chains-68c757ba.js";import{x as A,r as P,o as X,a7 as i,aa as Y,y as l,z as h,J as Z,H as y,I as o,P as d,A as w,M as m,O as n,u as a,F as E,a0 as F,L as v}from"./runtime-core.esm-bundler-c80a0204.js";const tt={style:{"word-wrap":"break-word"}},et={key:0},at={key:1},nt={style:{"word-wrap":"break-word"}},ot={class:"block"},rt={style:{"word-wrap":"break-word"}},lt={style:{"word-wrap":"break-word"}},st={style:{display:"flex","align-items":"left"}},ct=A({name:"TransactionsQueue"}),pt=A({...ct,props:{connectedWallet:{type:Object,default:null},web3:{type:Object,default:null},currentWallet:{type:String,default:""}},setup(M){const e=M,_=P(!1),C=P([]),I=async()=>{_.value=!0;const c=T(W,e.currentWallet,e.web3);C.value=[];const f=(await c.methods.getTransactionIds(0).call()).map(async p=>{const u=await c.methods.getTransaction(p).call(),S=await c.methods.getTransactionConfirmationStatus(p,e.connectedWallet.address).call(),B=await e.web3.eth.getChainId(),k=U(B),N=await z(c,u),b={id:p,destination:u.to,tokenSymbol:"",value:null,data:null,confirmations:u.confirmations,revokes:u.revokes,executeState:u.state,confirmStatus:S,type:1,methodName:"",events:N};let g=null;u.to.toLowerCase()===e.currentWallet.toLowerCase()?g=J(u):g=q(u,k,e.web3);const D={...b,...g};C.value.push(D)});await Promise.all(f),C.value.sort(G("id")),_.value=!1};X(()=>{e.connectedWallet&&e.web3&&e.currentWallet&&I()});const V=c=>{_.value=!0,T(W,e.currentWallet,e.web3).methods.confirmTransaction(c.id).send({from:e.connectedWallet.address}).then(async()=>{await I()}).catch(f=>{console.error(f)}).finally(()=>{_.value=!1})},H=c=>{_.value=!0,T(W,e.currentWallet,e.web3).methods.executeTransaction(c.id).send({from:e.connectedWallet.address}).then(async()=>{await I()}).catch(f=>{console.error(f)}).finally(()=>{_.value=!1})},Q=c=>{_.value=!0,T(W,e.currentWallet,e.web3).methods.revokeTransaction(c.id).send({from:e.connectedWallet.address}).then(async()=>{await I()}).catch(f=>{console.error(f)}).finally(()=>{_.value=!1})};return(c,x)=>{const f=i("el-divider"),p=i("el-tag"),u=i("el-card"),S=i("el-timeline-item"),B=i("el-timeline"),k=i("el-table-column"),N=i("IconifyIconOffline"),b=i("el-dropdown-item"),g=i("el-dropdown-menu"),D=i("el-dropdown"),R=i("el-table"),$=Y("loading");return l(),h("div",null,[Z((l(),y(R,{data:C.value,style:{width:"100%"}},{default:o(()=>[d(k,{type:"expand"},{default:o(t=>[w("p",tt,[m(n(a(r)("transaction.destination"))+": ",1),d(K,{text:t.row.destination},null,8,["text"])]),t.row.type==2?(l(),h("div",et,[(l(!0),h(E,null,F(t.row.data,(s,L)=>(l(),h("p",{style:{"word-wrap":"break-word"},key:L},n(a(r)("transaction."+s.name))+": "+n(s.value),1))),128))])):v("",!0),t.row.type==1?(l(),h("div",at,[w("p",nt,n(a(r)("transaction.amount"))+": "+n(t.row.value)+" "+n(t.row.tokenSymbol),1)])):v("",!0),d(f),w("div",ot,[t.row.events.length>0?(l(),y(B,{key:0},{default:o(()=>[(l(!0),h(E,null,F(t.row.events,(s,L)=>(l(),y(S,{key:L,timestamp:s.createTime,placement:"top"},{default:o(()=>[d(u,null,{default:o(()=>[w("h4",null,[m(n(a(r)("transaction.eventName"))+": ",1),d(p,{type:a(O)[s.eventName].tagType},{default:o(()=>[m(n(a(O)[s.eventName].name?a(r)("transaction."+a(O)[s.eventName].name):""),1)]),_:2},1032,["type"])]),w("p",rt,[m(n(a(r)("transaction.eventFrom"))+": ",1),w("span",null,n(s.from),1)]),w("p",lt,[m(n(a(r)("transaction.eventTransactionHash"))+": ",1),w("span",null,n(s.transactionHash),1)])]),_:2},1024)]),_:2},1032,["timestamp"]))),128))]),_:2},1024)):v("",!0)])]),_:1}),d(k,{label:a(r)("transaction.type")},{default:o(t=>[w("div",st,[t.row.type==1?(l(),y(p,{key:0,type:"success"},{default:o(()=>[m(n(a(r)("transaction."+t.row.methodName)),1)]),_:2},1024)):v("",!0),t.row.type==2?(l(),y(p,{key:1,type:"warning"},{default:o(()=>[m(n(a(r)("transaction."+t.row.methodName)),1)]),_:2},1024)):v("",!0)])]),_:1},8,["label"]),d(k,{label:a(r)("assets.operation")},{default:o(t=>[d(D,{trigger:"click"},{dropdown:o(()=>[d(g,null,{default:o(()=>[t.row.confirmStatus?v("",!0):(l(),y(b,{key:0,onClick:s=>V(t.row)},{default:o(()=>[m(n(a(r)("transaction.btnConfirm")),1)]),_:2},1032,["onClick"])),t.row.confirmStatus?v("",!0):(l(),y(b,{key:1,onClick:s=>Q(t.row)},{default:o(()=>[m(n(a(r)("transaction.btnRevoke")),1)]),_:2},1032,["onClick"])),d(b,{onClick:s=>H(t.row),divided:!t.row.confirmStatus},{default:o(()=>[m(n(a(r)("transaction.btnExecute")),1)]),_:2},1032,["onClick","divided"])]),_:2},1024)]),default:o(()=>[d(N,{icon:a(j),class:"text-[24px]"},null,8,["icon"])]),_:2},1024)]),_:1},8,["label"])]),_:1},8,["data"])),[[$,_.value]])])}}});export{pt as _};
